<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Manual</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="manual0.bmp" alt="[manual0]">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="6">GeoBUGS User Manual</font><font face="Arial" color="#000100" size="6"><strong><sup><br></sup></strong></font><font face="Arial" color="#000100" size="2"><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="4">Version 3.2.3, March 2014</font><font face="Arial" color="#000100" size="2"><br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Andrew Thomas</font><font face="Arial" color="#000100" size="1"><sup>1</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Nicky Best</font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;Dave Lunn</font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Richard Arnold</font><font face="Arial" color="#000100" size="1"><sup>3</sup></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;David Spiegelhalter</font><font face="Arial" color="#000100" size="1"><sup>4</sup></font><font face="Arial" color="#000100" size="3"> <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>1</sup></font><font face="Arial" color="#000100" size="3"> Dept of Mathematics &amp; Statistics,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;University of St Andrews<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;St Andrews<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scotland<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> Department of Epidemiology &amp; Public Health,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Imperial College School of Medicine,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Norfolk Place,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;London W2 1PG, UK<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>3</sup></font><font face="Arial" color="#000100" size="3"> School of Mathematical and Computing Sciences <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Victoria University, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P. O. Box 600, Wellington, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New Zealand<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><sup>4</sup></font><font face="Arial" color="#000100" size="1"><sup> </sup></font><font face="Arial" color="#000100" size="3">MRC Biostatistics Unit,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Institute of Public Health,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Robinson Way,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cambridge CB2 2SR, UK<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e-mail:&nbsp;&nbsp;&nbsp;bugs@mrc-bsu.cam.ac.uk&nbsp;&nbsp;&nbsp;[general]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;helsinkiant@gmail.com&nbsp;&nbsp;&nbsp;[technical]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;internet:&nbsp;&nbsp;&nbsp;http://www.mrc-bsu.cam.ac.uk/bugs<br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Top">Contents</a></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Intro">Introduction</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Import">Importing&nbsp;map&nbsp;polygon&nbsp;files</a> </strong></font><font face="Courier New" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Splus">Splus&nbsp;format</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ArcInfo">ArcInfo&nbsp;format</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Epimap">Epimap&nbsp;format</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ArcView">ArcView&nbsp;format</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Load">Loading&nbsp;a&nbsp;polygon&nbsp;file&nbsp;into&nbsp;GeoBUGS</a><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Export">Exporting&nbsp;maps&nbsp;from&nbsp;GeoBUGS&nbsp;into&nbsp;Splus&nbsp;format</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Adj">Producing&nbsp;adjacency&nbsp;matrices</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Edit">Editing&nbsp;adjacency&nbsp;matrices</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Maps">Producing&nbsp;maps</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Cuts">User-specified&nbsp;cut-points&nbsp;and&nbsp;shading</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Identify">Identifying&nbsp;individual&nbsp;areas&nbsp;on&nbsp;a&nbsp;map</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Save">Copying&nbsp;and&nbsp;saving&nbsp;maps</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Spatial">Spatial&nbsp;distributions</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#car.normal">car.normal&nbsp;and&nbsp;car.l1</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#car.proper">car.proper</a> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#spatial.exp">spatial.exp&nbsp;and&nbsp;spatial.disc</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#spatial.exp.pred">spatial.pred&nbsp;and&nbsp;spatial.unipred</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pois.conv">pois.conv</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mv.car">mv.car</a><br>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Temporal">Temporal&nbsp;distributions</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rw">Using&nbsp;car.normal&nbsp;as&nbsp;a&nbsp;random&nbsp;walk&nbsp;prior&nbsp;for&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temporal&nbsp;smoothing</a><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3"><strong><a href="#Examples">Examples</a></strong></font><font face="Courier New" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Scotland.html">Conditional&nbsp;Autoregressive&nbsp;(CAR)&nbsp;models&nbsp;for&nbsp;disease&nbsp;mapping:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lip&nbsp;cancer&nbsp;in&nbsp;Scotland</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/LHA.html">Convolution&nbsp;priors:&nbsp;Lung&nbsp;cancer&nbsp;in&nbsp;a&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;London&nbsp;Health&nbsp;Authority</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Scotland1.html">Proper&nbsp;CAR&nbsp;model:&nbsp;Lip&nbsp;cancer&nbsp;revisited</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Elevation.html">Bayesian&nbsp;kriging&nbsp;and&nbsp;spatial&nbsp;prediction:&nbsp;Surface&nbsp;elevation</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Forest.html">Poisson-gamma&nbsp;spatial&nbsp;moving&nbsp;average&nbsp;(convolution)&nbsp;model:&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distribution&nbsp;of&nbsp;hickory&nbsp;trees&nbsp;in&nbsp;Duke&nbsp;forest</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Huddersfield.html">Poisson-gamma&nbsp;spatial&nbsp;moving&nbsp;average&nbsp;(convolution)&nbsp;model:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ecological&nbsp;regression&nbsp;of&nbsp;air&nbsp;pollution&nbsp;and&nbsp;respiratory&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;illness&nbsp;in&nbsp;children</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/MVCAR.html">Intrinsic&nbsp;multivariate&nbsp;CAR&nbsp;prior&nbsp;for&nbsp;mapping&nbsp;multiple&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diseases:Oral&nbsp;cavity&nbsp;cancer&nbsp;and&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;West&nbsp;Yorkshire&nbsp;(UK)</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Shared.html">Shared&nbsp;component&nbsp;for&nbsp;mapping&nbsp;multiple&nbsp;diseases:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oral&nbsp;cavity&nbsp;cancer&nbsp;and&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;West&nbsp;Yorkshire&nbsp;(UK)</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Pollution.html">Random&nbsp;walk&nbsp;priors&nbsp;for&nbsp;temporal&nbsp;smoothing&nbsp;of&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;daily&nbsp;air&nbsp;pollution&nbsp;estimates</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Appendix">Appendix&nbsp;1:&nbsp;Technical&nbsp;details&nbsp;of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Structured&nbsp;Multivariate Gaussian&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and Conditional&nbsp;Autoregressive&nbsp;(CAR)&nbsp;models&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;hyperprior specification</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Joint">Joint&nbsp;specification</a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Conditional">Conditional&nbsp;specification</a> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Intrinsic">Intrinsic&nbsp;CAR&nbsp;model</a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Proper">Proper&nbsp;CAR&nbsp;model</a><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MV">Intrinsic&nbsp;Multivariate&nbsp;CAR&nbsp;model</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Appendix 2">Appendix&nbsp;2:&nbsp;Technical&nbsp;details&nbsp;of&nbsp;the&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Poisson-gamma&nbsp;Spatial&nbsp;Moving&nbsp;Average<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convolution&nbsp;model</a><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Refs">References</a><br><br></font><font face="Arial" color="#000100" size="3"><strong><sub><br></sub></strong></font><font face="Arial" color="#000100" size="5"><strong><a id="Intro"></strong></font><font face="Courier New" color="#000100" size="6">Introduction</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#0000FF" size="3"><a href="#Top"> [top]</a></font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS is an add-on module to WinBUGS which provides an interface for: <br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#Maps"></font><font face="Arial" color="#0000FF" size="3">producing&nbsp;maps</font><font face="Arial" color="#000100" size="3"></a> of the output from disease mapping and other spatial models<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3">creating</font><font face="Arial" color="#000100" size="3"></a> and <a href="#Edit"></font><font face="Arial" color="#0000FF" size="3">manipulating</font><font face="Arial" color="#000100" size="3"></a> adjacency matrices that are required as input for the<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#car.normal"></font><font face="Arial" color="#0000FF" size="3">conditional&nbsp;autoregressive&nbsp;models</font><font face="Arial" color="#000100" size="3"></a> available in OpenBUGS for carrying out<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spatial smoothing. <br><br>GeoBUGS contains map files for<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Districts in Scotland (called </font><font face="Arial" color="#000100" size="3"><strong><em>Scotland</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Wards in a London Health Authority (called </font><font face="Arial" color="#000100" size="3"><strong><em>London_HA</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Counties in Great Britain (called </font><font face="Arial" color="#000100" size="3"><strong><em>GB_Counties</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Departements in France (called </font><font face="Arial" color="#000100" size="3"><strong><em>France</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Nomoi in Greece (called </font><font face="Arial" color="#000100" size="3"><strong><em>Greecenomoi</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Districts in Belgium (called </font><font face="Arial" color="#000100" size="3"><strong><em>Belgium</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Communes in Sardinia (called </font><font face="Arial" color="#000100" size="3"><strong><em>Sardinia</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Subquarters in Munich (called </font><font face="Arial" color="#000100" size="3"><strong><em>Munich</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A 15 x 15 regular grid (called </font><font face="Arial" color="#000100" size="3"><strong><em>Elevation</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Wards in West Yorkshire (UK) (called </font><font face="Arial" color="#000100" size="3"><strong><em>WestYorkshire</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A 4 x 4 regular grid (called </font><font face="Arial" color="#000100" size="3"><strong><em>Forest</em></strong></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> A grid of 750 m</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> grid cells covering the town of Huddersfield and surroundings in <br>&nbsp;&nbsp;&nbsp;northern England (called </font><font face="Arial" color="#000100" size="3"><strong><em>Huddersfield_750m_grid)</em></strong></font><font face="Arial" color="#000100" size="3"><br><br>A list of the area IDs for each map and the order in which the areas are stored in the map file can be obtained using the <a href="#Export"></font><font face="Arial" color="#0000FF" size="3">export&nbsp;Splus</font><font face="Arial" color="#000100" size="3"></a> command. <br><br>GeoBUGS also has facilities for importing user-defined maps reading polygon formats from</font><font face="Arial" color="#0000FF" size="3"> <a href="#Splus">Splus</font><font face="Arial" color="#0000FF" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3">,</font><font face="Arial" color="#0000FF" size="3"> <a href="#ArcInfo">ArcInfo</font><font face="Arial" color="#0000FF" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3"> and</font><font face="Arial" color="#0000FF" size="3"> <a href="#Epimap">Epimap</font><font face="Arial" color="#0000FF" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3">, plus a link to a program written by Yue Cui for importing </font><font face="Arial" color="#0000FF" size="3"><a href="#ArcView">ArcView</a></font><font face="Arial" color="#000100" size="3"> shape files. <br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Import"></strong></font><font face="Courier New" color="#000100" size="6">Importing map polygon files</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#0000FF" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Polygon files can be imported into GeoBUGS from a variety of other packages:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><a href="#Splus">Splus</a></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><a href="#ArcInfo">ArcInfo</a></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><a href="#Epimap">Epimap</a></font><font face="Symbol" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#0000FF" size="3"><a href="#ArcView">ArcView</font><font face="Arial" color="#0000FF" size="3"><u></a></u></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Import files are text files containing:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Number of regions in the map<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> List of labels for each region, with corresponding ID number<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> List of x and y co-ordinates for each polygon, plus the polygon label</font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3">The different GeoBUGS import formats are designed to follow as closely as possible the format in which Splus, ArcInfo and EpiMap export polygons, respectively. However, some manual editing of the polygon files exported from these various packages is also necessary before they can be read into GeoBUGS. <br><br>The following simple map is used to illustrate the different import formats. The map contains 3 areas (labelled area 1, area 2 and area 3); area 1 consists of 2 separate polygons, while areas 2 and 3 consist of one polygon each.<br><br></font><font face="Arial" color="#FF0000" size="2"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="manual1.bmp" alt="[manual1]"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Splus"></strong></font><font face="Courier New" color="#000100" size="6">Splus format</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#0000FF" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map:3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">Xscale: 1000<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">Yscale: 1000</font><font face="Arial" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 area3<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 0 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 1 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 0 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 4 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 4 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area1 2 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area2 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NA NA NA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 3 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 3 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area3 2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">The Splus import file is in three parts:<br><br>The first line contains the key word 'map' (lower case) followed by a colon and an integer, N, where N is the number of distinct areas in the map (note that one area can consist of more than one polygon). <a id="xscale">The 2nd and 3rd lines are </font><font face="Arial" color="#000100" size="3"><em>optional</em></font><font face="Arial" color="#000100" size="3">, and can be used to specify the units for the map scale. By default, GeoBUGS assumes that the polygon coordinates are measured in metres. If the coordinates are measured in kilometres, say, then specify Xscale and Yscale to be 1000. GeoBUGS will then multiply all polygon co-ordinates by Xscale and Yscale as appropriate before storing the map file. If Xscale and Yscale are not specified, then the default units (metres) are assumed.</a><br><br>The next part of the import file is a 2 column list giving:<br><br>(column 1) the numeric ID of the area - this must be a unique integer between 1 and N; the areas should be labelled in the same order as the corresponding data for that area appears in the model.<br>(column 2) the area label - this must start with a character, and can be a maximum of 79 alphanumeric characters (no spaces allowed)<br><br>The final part of the import file is a 3 column list giving the co-ordinates of the polygons. The format is:<br><br>(col 1) the label of the area to which the polygon belongs<br>(col 2) x-coordinate<br>(col 3) y-xoordinate<br><br>The polygon coordinates can be listed either clockwise or anticlockwise. Polygons should be separated by a row of NA's<br><br>The import file should end with the key word: END<br><br>Note: Brad Carlin has a link on his web page to an Splus program called poly.S to extract polygons for any state in the United States in the appropriate format for loading into GeoBUGS (http://www.biostat.umn.edu/~brad/software.html)<br></font><font face="Arial" color="#000100" size="3"><strong><br><br><a id="ArcInfo"></strong></font><font face="Courier New" color="#000100" size="6">ArcInfo format</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map:3<br></font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Xscale: 1000<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Yscale: 1000<br></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 area3<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103 area1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;210 area2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;211 area3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;99 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;103 0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;210 0 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;211 0 0 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 0<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">The ArcInfo import file is in four parts:<br><br>The first 2 parts are the same as the Splus format. <br><br>The third part begins with a line containing the key word 'regions' (lower case). Below this is a 2 column list giving:<br><br>(column 1) an integer label corresponding to the integer label for one of the polygons listed in the final part of the import file. Each polygon should have a unique integer label, but this can be arbitrary (i.e. labels don't need to start at 1 or be consecutive). If using the ArcInfo command UNGENERATE to export a set of polygons, this is the integer label that ArcInfo automatically attaches to each polygon.<br>(column 2) the area label to which the polygon with that integer ID belongs. Note, if an area contains more than one polygon, then each polygon ID should be listed on a separate line and given the same area label (e.g., area1 in the above example).<br><br>There should be as many rows in this part of the file as there are polygons. This will be equal to or greater than the number of distinct areas in the map.<br><br>The final part of the import file gives the co-ordinates of the polygons. The format for each polygon is:<br><br>(row 1, column 1) the integer ID for the polygon (this should correspond to one of the integer IDs listed in the previous part of the import file).<br>(row 1, columns 2 and 3) if the polygon file has been exported directly from ArcInfo, these 2 numbers usually give the centroid of the polygon. However, they are not used by GeoBUGS, so can be arbitrary.<br>Subsequent rows contain a 2-column list of numbers giving the x- and y-coordinates of the poly. The polygon coordinates can be listed either clockwise or anticlockwise. <br><br>Polygons should be separated by a line containing the key word END.<br><br>The final row of the import file should also contain the key word END</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Epimap"></strong></font><font face="Courier New" color="#000100" size="6">Epimap format</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">map:3<br></font><font face="Arial" color="#FF0000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">Xscale: 1000<br></font><font face="Arial" color="#FF0000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">Yscale: 1000<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1 area1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2 area2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3 area3<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area1, 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1, 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">1, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area1, 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">4, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">4, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area2, 4 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">0, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">area3, 4 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3, 0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">3, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">2, 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">END<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3">The Epimap import file is in three parts:<br><br>The first 2 parts are the same as the Splus format. <br><br>The third gives the polygon co-ordinates. The format for each polygon is:<br><br>(row 1, column 1) the label of the area to which the polygon belongs.<br>(row 1, column 2) the number of vertices in the polygon (note the comma separator)<br>Subsequent rows contain a 2-column list of numbers giving the x- and y-coordinates of the poly, separated by a comma. The polygon coordinates can be listed either clockwise or anticlockwise. <br><br>The final row of the import file should contain the key word END<br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="ArcView"></strong></font><font face="Courier New" color="#000100" size="6">ArcView format</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS does not have an option for loading ArcView shape files directly. However, Ms Yue Cui at the University of Minnesota has written programs in Splus and R for converting shape files into the GeoBUGS Splus format so that they can be loaded in GeoBUGS (http://www.biostat.umn.edu/~yuecui/). </font><font face="Arial" color="#0000FF" size="3"><br><br><br></font><font face="Arial" color="#000000" size="3"><strong><a id="Load"></strong></font><font face="Courier New" color="#000100" size="6">Loading a polygon file into GeoBUGS</font><font face="Arial" color="#000000" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#0000FF" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Open the polygon file as a separate text file in OpenBUGS and select the appropriate import option from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. (To try loading the example map files above, first copy them to a separate file, and focus the window containing this file). If the map has been loaded correctly, a </font><font face="Arial" color="#000100" size="3"><strong><em>Save As</em></strong></font><font face="Arial" color="#000100" size="3"> dialog box will appear, prompting you to enter a name for the map file. By default, the map file will be saved in the </font><font face="Courier" color="#000100" size="3">Maps/Rsrc</font><font face="Arial" color="#000100" size="3"> subdirectory of your OpenBUGS program, with a </font><font face="Courier" color="#000100" size="3">.map</font><font face="Arial" color="#000100" size="3"> extension. You can view this map by selecting </font><font face="Arial" color="#000100" size="3"><strong><em>Open</em></strong></font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#000100" size="3"><strong><em>File</em></strong></font><font face="Arial" color="#000100" size="3"> menu (go to the </font><font face="Courier" color="#000100" size="3">Maps/Rsrc</font><font face="Arial" color="#000100" size="3"> subdirectory and select file type: </font><font face="Courier" color="#000100" size="3">map file (*.map)</font><font face="Arial" color="#000100" size="3">. You will need to exit OpenBUGS and re-start before the new map will appear on the pull-down list of avaialble maps in the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> of the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. </font><font face="Arial" color="#0000FF" size="3"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Export"></strong></font><font face="Courier New" color="#000100" size="6">Exporting maps from GeoBUGS into Splus format</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Focus the window containing the map in GeoBUGS and select </font><font face="Arial" color="#000100" size="3"><strong><em>Export Splus</em></strong></font><font face="Arial" color="#000100" size="3"> from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu. This will write the map in Splus format to a new window. This command can be used to obtain the list of area IDs and the order in which they are specified in the GeoBUGS map (see top part of export file).<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Adj"></strong></font><font face="Courier New" color="#000100" size="6">Producing adjacency matrices</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS includes an option to produce a data file containing the adjacency matrix for any map loaded on the system. This file is in a format required by the</font><font face="Arial" color="#0000FF" size="3"> <a href="#car.normal">car.normal</a></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#0000FF" size="3"><a href="#car.normal">car.l1</font><font face="Arial" color="#000100" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3"> and</font><font face="Arial" color="#0000FF" size="3"> <a href="#mv.car">mv.car</a></font><font face="Arial" color="#000100" size="3"> conditional autoregressive distributions available in the OpenBUGS program.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> option from the</font><font face="Arial" color="#000100" size="3"><strong><em> Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><img src="manual2.bmp" alt="[manual2]"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the name of the map you wish to draw from the pull-down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> and<br>&nbsp;&nbsp;&nbsp;click on </font><font face="Arial" color="#000100" size="3"><strong><em>adj map</em></strong></font><font face="Arial" color="#000100" size="3">. The selected map will then appear in a window.<br><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> Typing the ID number of a region in the bottom white box and clicking </font><font face="Arial" color="#000100" size="3"><strong><em>shw region</em></strong></font><font face="Arial" color="#000100" size="3"> will<br>&nbsp;&nbsp;&nbsp;cause the specified region to be highlighted in red on the map; its neighbours (defined to<br>&nbsp;&nbsp;&nbsp;be any region adjacent to the red region) are highlighted in green. <a id="highlight">A region and its<br>&nbsp;&nbsp;&nbsp;neighbours can also be highlighted by positioning the mouse cursor over the required<br>&nbsp;&nbsp;&nbsp;region on the map and clicking with the left button.</a><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a text file containing the adjacency matrix in a<br>&nbsp;&nbsp;&nbsp;form suitable for loading as data into OpenBUGS for use with the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">and<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distributions. (See </font><font face="Arial" color="#0000FF" size="3"><a href="#Appendix">appendix 1</a></font><font face="Arial" color="#000100" size="3"> for further details about these three<br>&nbsp;&nbsp;&nbsp;distributions).<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">Note: when calculating which areas are adjacent to which others, GeoBUGS includes a<br>&nbsp;&nbsp;&nbsp;'tolerance' zone of 0.1 metres. This tolerance zone should not lead to spurious neighbours<br>&nbsp;&nbsp;&nbsp;unless you forget to appropriately scale your distance units in the polygon file using the <br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3"><a href="#xscale">Xscale</a> </font><font face="Arial" color="#000000" size="3">and </font><font face="Arial" color="#0000FF" size="3"><a href="#xscale">Yscale</a></font><font face="Arial" color="#000100" size="3"> options, or your map covers a tiny geographic region (in<br>&nbsp;&nbsp;&nbsp;which case, artificially re-scaling the distance units for your map should overcome any<br>&nbsp;&nbsp;&nbsp;problems). <br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Edit"></strong></font><font face="Courier New" color="#000100" size="6">Editing adjacency matrices</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><strong></strong></font><font face="Arial" color="#000100" size="3"><br>To remove a region from the set of neighbours for a specific area:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#highlight"></font><font face="Arial" color="#0000FF" size="3">Highlight</font><font face="Arial" color="#000100" size="3"></a> the specific area in red on the map;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Place the mouse cursor over the region to be removed from the set of neighbours for the<br>&nbsp;&nbsp;&nbsp;red area;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Hold down the Ctrl key while clicking with the left mouse button. The removed area will no<br>&nbsp;&nbsp;&nbsp;longer be highlighted in green.<br><br>To add a region to the set of neighbours for a specific area:<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> <a href="#highlight"></font><font face="Arial" color="#0000FF" size="3">Highlight</font><font face="Arial" color="#000100" size="3"></a> the specific area in red on the map;<br><br>&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Place the mouse cursor over the region to be added to the set of neighbours for the <br>&nbsp;&nbsp;&nbsp;red area</font><font face="Symbol" color="#000100" size="2"><strong><br></strong></font><font face="Symbol" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Hold down the Ctrl key while clicking with the left mouse button. The additional area will<br>&nbsp;&nbsp;&nbsp;then become highlighted in green.<br><br>Once you have finished editing the set of neighbours for each region on your map, <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3">create&nbsp;the&nbsp;new&nbsp;adjacency&nbsp;matrix</font><font face="Arial" color="#000100" size="3"></a> by clicking on the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> button.<br><br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="5"><strong><a id="Maps"></strong></font><font face="Courier New" color="#000100" size="6">Producing maps</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Note: in order to produce a map of the mean or other summary statistic of the posterior distribution of a stochastic variable, you must have already set a samples or summary monitor for that parameter and have carried out some updates.<br><br>To produce a map:<br><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>Mapping Tool</em></strong></font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu.<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><img src="manual3.bmp" alt="[manual3]"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the name of the map you wish to draw from the pull-down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Type the name of the variable to be mapped in the white box labelled</font><font face="Arial" color="#000100" size="3"><strong><em> Variable</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> If the variable is </font><font face="Arial" color="#000100" size="3"><em>data</em></font><font face="Arial" color="#000100" size="3"> (e.g. the raw SMR, expected counts E, or a covariate) pick the<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>value</em></strong></font><font face="Arial" color="#000100" size="3"> option in the pull down menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>Quantity</em></strong></font><font face="Arial" color="#000100" size="3"> and then click the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button: a map<br>&nbsp;&nbsp;&nbsp;shaded according to the values of the variable will now appear.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> If the variable is a</font><font face="Arial" color="#000100" size="3"><em> stochastic</em></font><font face="Arial" color="#000100" size="3"> quantity (e.g. the relative risks) there are various options<br>&nbsp;&nbsp;&nbsp;which you can select from the </font><font face="Arial" color="#000100" size="3"><strong><em>Quantity</em></strong></font><font face="Arial" color="#000100" size="3"> menu:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> if you have monitored the variable by setting a</font><font face="Arial" color="#000100" size="3"><em> summary monitor</em></font><font face="Arial" color="#000100" size="3">, then you must select<br>&nbsp;&nbsp;&nbsp;the </font><font face="Arial" color="#000100" size="3"><strong><em>mean(summary) </em></strong></font><font face="Arial" color="#000100" size="3">option from this menu, as only the posterior means are stored by the<br>&nbsp;&nbsp;&nbsp;summary monitor;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> if you have monitored the variable by setting a </font><font face="Arial" color="#000100" size="3"><em>samples monitor</em></font><font face="Arial" color="#000100" size="3"> (which stores the full<br>&nbsp;&nbsp;&nbsp;posterior sample), you can select any of the remaining options from the Quantity menu:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>mean(sample)</em></strong></font><font face="Arial" color="#000100" size="3"> will map the posterior means of the variable;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>percentile</em></strong></font><font face="Arial" color="#000100" size="3"> will plot posterior quantiles of the variable - if you select this option, you must<br>&nbsp;&nbsp;&nbsp;then type the required percentile in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>quantile</em></strong></font><font face="Arial" color="#000100" size="3">; <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>prob greater </em></strong></font><font face="Arial" color="#000100" size="3">will map the posterior probability that the value of the variable is greater than<br>&nbsp;&nbsp;&nbsp;or equal to the specified threshold, which you must type in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>threshold</em></strong></font><font face="Arial" color="#000100" size="3">;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>prob less</em></strong></font><font face="Arial" color="#000100" size="3"> will map the posterior probability that the value of the variable is less than or<br>&nbsp;&nbsp;&nbsp;equal to the specified threshold, which you must type in the box labelled </font><font face="Arial" color="#000100" size="3"><strong><em>threshold</em></strong></font><font face="Arial" color="#000100" size="3">;<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">When you have selected the quantity you want to map, click the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to display the<br>&nbsp;&nbsp;&nbsp;map. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The numbers in brackets shown on the map legend give the number of areas classified in<br>&nbsp;&nbsp;&nbsp;each category on the map.<br><br>Fig 1. GeoBUGS map of SMRs for Scottish Lip Cancer data <br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="2"><img src="manual4.bmp" alt="[manual4]"><br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Cuts"></strong></font><font face="Courier New" color="#000100" size="6">User-specified cut-points and shading</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>GeoBUGS can work with two kinds of cut-points: absolute value cut-points and percentile cut-points. For absolute cut-points, GeoBUGS chooses a default set of breaks based on the absolute value of the variable to be mapped: these are chosen to give equally spaced intervals. For percentile cutpoints, GeoBUGS chooses the 10th, 50th and 90th percentiles of the empirical distribution of the variable to be mapped. The default shading is blue-scale. <br><br>To edit the colours for shading the map:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>custom</em></strong></font><font face="Arial" color="#000100" size="3"> option from the</font><font face="Arial" color="#000100" size="3"><strong><em> Palette</em></strong></font><font face="Arial" color="#000100" size="3"> menu in the top right of the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Clicking with the left mouse button on the arrow by each colour will bring up a menu of<br>&nbsp;&nbsp;&nbsp;alternative colours that can be selected.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> After you have selected the new colour scheme, click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button to &quot;refresh&quot;<br>&nbsp;&nbsp;&nbsp;the currently selected map or click on the</font><font face="Arial" color="#000100" size="3"><strong><em> plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a new map.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> To reset the colour scheme to blue shades, select </font><font face="Arial" color="#000100" size="3"><strong><em>blues</em></strong></font><font face="Arial" color="#000100" size="3"> from the Palette menu and click<br>&nbsp;&nbsp;&nbsp;on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts </em></strong></font><font face="Arial" color="#000100" size="3">button again. <br><br>To edit the absolute value cutpoints:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the required number of cutpoints (a maximum of 6 cutpoints is currently allowed)<br>&nbsp;&nbsp;&nbsp;from the menu labelled </font><font face="Arial" color="#000100" size="3"><strong><em>num cuts</em></strong></font><font face="Arial" color="#000100" size="3"> under the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts</em></strong></font><font face="Arial" color="#000100" size="3"> menu. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Type the required values of the cutpoints in the appropriate boxes labelled cut 1, cut 2<br>&nbsp;&nbsp;&nbsp;etc.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button to &quot;refresh&quot; the currently selected map or click on the </font><font face="Arial" color="#000100" size="3"><strong><em>plot<br>&nbsp;&nbsp;&nbsp;</em></strong></font><font face="Arial" color="#000100" size="3">button to produce a new map.<br><br>To produce maps using cutpoints based on percentiles:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the </font><font face="Arial" color="#000100" size="3"><strong><em>percentile</em></strong></font><font face="Arial" color="#000100" size="3"> option rather than </font><font face="Arial" color="#000100" size="3"><strong><em>abs value</em></strong></font><font face="Arial" color="#000100" size="3"> option for the cutpoints on the left of<br>&nbsp;&nbsp;&nbsp;the </font><font face="Arial" color="#000100" size="3"><strong><em>Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>plot</em></strong></font><font face="Arial" color="#000100" size="3"> button to produce a new map. The default is to set the cutpoints to the<br>&nbsp;&nbsp;&nbsp;10th, 50th and 90th percentiles of the empirical distribution of values to be mapped.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> To display the absolute values corresponding to these percentiles on the map legend:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> reselect the </font><font face="Arial" color="#000100" size="3"><strong><em>abs value</em></strong></font><font face="Arial" color="#000100" size="3"> option for cutpoints;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> click on the </font><font face="Arial" color="#000100" size="3"><strong><em>get cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the absolute values corresponding to the percentiles should<br>&nbsp;&nbsp;&nbsp;now be displayed in the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts</em></strong></font><font face="Arial" color="#000100" size="3"> boxes on the right of the</font><font face="Arial" color="#000100" size="3"><strong><em> Map Tool</em></strong></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3"> click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the legend labels on the map should now display the<br>&nbsp;&nbsp;&nbsp;absolute values of the cutpoints.<br><br>To use the same set of cutpoints for multiple maps:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the window with the map containing the cutpoints you wish to use.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the</font><font face="Arial" color="#000100" size="3"><strong><em> get cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the cutpoints used for the selected map should now be<br>&nbsp;&nbsp;&nbsp;displayed in the </font><font face="Arial" color="#000100" size="3"><strong><em>Cuts </em></strong></font><font face="Arial" color="#000100" size="3">boxes on the right of the</font><font face="Arial" color="#000100" size="3"><strong><em> Map Tool</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Select the window with the map whose cutpoints you wish to change.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> Click on the </font><font face="Arial" color="#000100" size="3"><strong><em>set cuts</em></strong></font><font face="Arial" color="#000100" size="3"> button - the map should now be updated using the new cutpoints.<br><br>Some current limitations:<br><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> It is not possible to save user-defined colour schemes once you quit GeoBUGS.<br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Identify"></strong></font><font face="Courier New" color="#000100" size="6">Identifying individual areas on a map</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>The index, label and value of an individual area on the map can be found by placing the cursor over the area of interest on the map and clicking with the left mouse button. The index (i.e. ID number i of the area, where i=1,...,Number of areas), area label (given in the polygon file) and value of variable currently being mapped for the selected area will be shown in left of the grey bar at the bottom of the WinBUGS program window.<br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Save"></strong></font><font face="Courier New" color="#000100" size="6">Copying and saving maps</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Maps produced using the GeoBUGS map tool can be copied and pasted into other Microsoft Windows software such as Word and PowerPoint. To select the map, click anywhere on the map window to focus it, then press the Ctrl and Space keys simultaneouly (a blue border should then appear around the figure); then select 'Copy' from the 'Edit' menu (or Crtl-C). Then paste into the appropriate Word or PowerPoint file etc. To save the map as a postscript file, you will need to install a postscript print driver on your PC, then select 'Print' from the 'File' menu, check the 'print to file' box, and then select 'Print'. You can also save the maps as OpenBUGS .odc documents; this will allow you to re-open the map within OpenBUGS and re-edit the cutpoints and colours if you wish.<br><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Spatial"></strong></font><font face="Courier New" color="#000100" size="6">Spatial distributions</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="3"><br>See <a href="#Appendix"></font><font face="Arial" color="#0000FF" size="3">appendices</a></font><font face="Arial" color="#000100" size="3"> for further tecnhical details about the various spatial distributions implemented in GeoBUGS 1.2.</font><font face="Arial" color="#000100" size="3"><strong><br><br>&nbsp;&nbsp;&nbsp;<a id="car.normal"></strong></font><font face="Courier New" color="#000100" size="6">car.normal and car.l1</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#0000FF" size="3"> [<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><br><br>The intrinsic Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random varables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> ). </sub></font><font face="Arial" color="#000100" size="3">A robust version of this model is available, which assumes a double exponential (Laplace) rather than Gaussian distribution: this is called</font><font face="Arial" color="#000100" size="3"><strong><em> car.l1</em></strong></font><font face="Arial" color="#000100" size="3">. The syntax for these distributions is as follows:<br><br>S[1:N] ~ car.normal(adj[], weights[], num[], tau)<br>S[1:N] ~ car.l1(adj[], weights[], num[], tau)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas. For the CAR model described above, taking C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 (equivalently W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/ n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ) if areas i and j are neighbours and 0 otherwise, gives a vector of 1's for </font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar argument representing the precision (inverse variance) parameter of the Gaussian CAR prior, or the inverse scale parameter of the Laplace prior (for the latter model, the variance = 2 / tau</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">).<br><br>The first 3 arguments must be entered as data (it is currently not possible to allow the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> to be unknown); the final variable </font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> is usually treated as unknown and so is assigned a prior distribution. The data variables </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3">above</font><font face="Arial" color="#000100" size="3"></a>. The variable</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> must be created by the user, and must be a vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">. A common choice is to set all the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">equal to 1 since this gives the standard Besag, York and Mollie (1991) CAR model (see section on <a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3">intrinsic&nbsp;CAR&nbsp;models</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1 for further discussion of weights). The easiest way to do this is to create a loop in your </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> model code:<br><br>for(j in 1:sumNumNneigh) { weights[j] &lt;- 1}<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>sumNumNneigh</em></strong></font><font face="Arial" color="#000100" size="3"> is the length of </font><font face="Arial" color="#000100" size="3"><strong><em>adj </em></strong></font><font face="Arial" color="#000100" size="3">and is also output by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS </em></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> .<br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">The</font><font face="Arial" color="#000100" size="3"><strong><em> car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions use </font><font face="Arial" color="#FF0000" size="3">unnormalised</font><font face="Arial" color="#000100" size="3"> weights (see section on<br>&nbsp;&nbsp;&nbsp;<a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3">intrinsic&nbsp;CAR&nbsp;models</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1).<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the<br>&nbsp;&nbsp;&nbsp;area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The weights must be </font><font face="Arial" color="#FF0000" size="3">symmetric</font><font face="Arial" color="#000100" size="3"> ( W</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="3"><sub>ji </sub></font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a check for this<br>&nbsp;&nbsp;&nbsp;and returns an error message if non-symmetric weights are detected.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on tau, and be prepared to carry out sensitivity analysis to this<br>&nbsp;&nbsp;&nbsp;choice.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The car.normal and car.l1 distributions are parameterised to include a </font><font face="Arial" color="#FF0000" size="3">sum-to-zero<br>&nbsp;&nbsp;&nbsp;constraint</font><font face="Arial" color="#000100" size="3"> on the random effects. This means that you must also include a </font><font face="Arial" color="#FF0000" size="3">separate<br>&nbsp;&nbsp;&nbsp;intercept </font><font face="Arial" color="#000100" size="3">term in your model, which MUST be assigned an improper uniform prior using the<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> distribution.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Because the car.normal and car.l1 distributions are improper, they can only be used as<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">prior</font><font face="Arial" color="#000100" size="3"> distributions, and not as a likelihood.<br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="car.proper"></strong></font><font face="Courier New" color="#000100" size="6">car.proper</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#0000FF" size="3"> [<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><br><br>The proper Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random variables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> ). </sub></font><font face="Arial" color="#000100" size="3">The syntax for this distributions is as follows:<br><br>S[1:N] ~ car.proper(mu[], C[], adj[], num[], M[], tau, gamma)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector giving the mean for each area (this can either be entered as data, assigned a prior distribution, or specified deterministically within the model code).<br></font><font face="Arial" color="#000100" size="3"><strong><em>C[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>normalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas (see sections on <a href="#Conditional"></font><font face="Arial" color="#0000FF" size="3">conditional&nbsp;specification</font><font face="Arial" color="#000100" size="3"></a> and <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3">proper&nbsp;CAR&nbsp;priors</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1). Note that this differs from the intrinsic </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3"> distributions, where unnormalised weights should be specified. <br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>M[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N giving the diagonal elements M</font><font face="Arial" color="#000100" size="3"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> of the conditional variance matrix (see sections on <a href="#Conditional"></font><font face="Arial" color="#0000FF" size="3">conditional&nbsp;specification</font><font face="Arial" color="#000100" size="3"></a> and <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3">proper&nbsp;CAR&nbsp;priors</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1)<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall precision (inverse variance) parameter.<br></font><font face="Arial" color="#000100" size="3"><strong><em>gamma</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall degree of spatial dependence. This parameter is constrained to lie between bounds given by the inverse of the minimum and maximum eigenvalues of the matrix </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"><sup>-</sup></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(see <a href="#Proper"></font><font face="Arial" color="#0000FF" size="3">appendix 1</a>&nbsp;</font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS 1.2</em></font><font face="Arial" color="#000100" size="3"> contains two deterministic functions for calculating these bounds (or they can be calculated externally to </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> and input by the user):<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">min.bound(C[], adj[], num[], M[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">max.bound(C[], adj[], num[], M[])<br><br>where the arguments are the same as the corresponding vectors used as arguments to the </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper</em></strong></font><font face="Arial" color="#000100" size="3"> distribution. <br><br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.proper </em></strong></font><font face="Arial" color="#000100" size="3">distribution:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>M</em></strong></font><font face="Arial" color="#000100" size="3"> must be entered as data (it is currently not possible to allow </font><font face="Arial" color="#000100" size="3"><strong><em>C </em></strong></font><font face="Arial" color="#000100" size="3">to be<br>&nbsp;&nbsp;&nbsp;unknown); </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3">above</font><font face="Arial" color="#000100" size="3"></a>. The <a href="../GeoBUGS/Examples/Scotland.html"></font><font face="Arial" color="#0000FF" size="3">Lips&nbsp;example</font><font face="Arial" color="#000100" size="3"></a> shows a (slightly<br>&nbsp;&nbsp;&nbsp;clumsy) way of creating the </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>M</em></strong></font><font face="Arial" color="#000100" size="3"> vectors within the WinBUGS model code;<br>&nbsp;&nbsp;&nbsp;alternatively, these can be created externally to </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> and read in as data.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The</font><font face="Arial" color="#000100" size="3"><strong><em> car.proper </em></strong></font><font face="Arial" color="#000100" size="3">distribution uses </font><font face="Arial" color="#FF0000" size="3">normalised</font><font face="Arial" color="#000100" size="3"> weights </font><font face="Arial" color="#000100" size="3"><strong><em>C</em></strong></font><font face="Arial" color="#000100" size="3"> (see section on<br>&nbsp;&nbsp;&nbsp;<a href="#Proper"></font><font face="Arial" color="#0000FF" size="3">proper&nbsp;CAR&nbsp;priors</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1).<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the<br>&nbsp;&nbsp;&nbsp;area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS<br>&nbsp;&nbsp;&nbsp;</em></font><font face="Arial" color="#000100" size="3">does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#FF0000" size="3">symmetry constraint</font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="3"><sub>jj</sub></font><font face="Arial" color="#000100" size="3"> = C</font><font face="Arial" color="#000100" size="3"><sub>ji </sub></font><font face="Arial" color="#000100" size="3">M</font><font face="Arial" color="#000100" size="3"><sub>ii </sub></font><font face="Arial" color="#000100" size="3">must be satisfied. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a<br>&nbsp;&nbsp;&nbsp;check for this and returns an error message if lack of symmetry is detected.<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on tau, and be prepared to carry out sensitivity analysis to this<br>&nbsp;&nbsp;&nbsp;choice.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on gamma: you must ensure that the prior is constrained between<br>&nbsp;&nbsp;&nbsp;the appropriate bounds. Besag, York and Mollie (1991) suggest that gamma needs to be<br>&nbsp;&nbsp;&nbsp;close to its upper bound before it reflects reasonable spatial dependence, so you may<br>&nbsp;&nbsp;&nbsp;want to try informative priors to represent this, and be prepared to carry out sensitivity<br>&nbsp;&nbsp;&nbsp;analysis.<br></font><font face="Arial" color="#000100" size="2"><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="spatial.exp"></strong></font><font face="Courier New" color="#000100" size="6">spatial.exp and spatial.disc</font><font face="Arial" color="#000100" size="3"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Bayesian Gaussian kriging models (multivariate Gaussian distribution with covariance matrix expressed as a parametric function of distance between pairs of points - e.g. see Diggle, Tawn and Moyeed, 1998 and <a href="#Appendix"></font><font face="Arial" color="#0000FF" size="3">Appendix&nbsp;1</font><font face="Arial" color="#000100" size="3"></a>) can be specified using the distributions </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp </em></strong></font><font face="Arial" color="#000100" size="3">or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> for the </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of random variables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="2"><sub>N</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">).</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">The syntax for this distributions is as follows: <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi, kappa)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S[1:N] ~ spatial.disc(mu[], x[], y[], tau, alpha)<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector giving the mean for each area (this can either be entered as data, assigned a prior distribution, or specified deterministically within the model code).<br></font><font face="Arial" color="#000100" size="3"><strong><em>x[] </em></strong></font><font face="Arial" color="#000100" size="3">and </font><font face="Arial" color="#000100" size="3"><strong><em>y[] </em></strong></font><font face="Arial" color="#000100" size="3">: Vectors of length N giving the x and y coordinates of the location of each point, or the centroid of each area<br></font><font face="Arial" color="#000100" size="3"><strong><em>tau</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the overall precision (inverse variance) parameter.<br><br>Two options are available for specifying the form of the covariance matrix: the powered exponential function and the 'disc' function (see section on </font><font face="Arial" color="#0000FF" size="3"><u><a href="#Joint"></u></font><font face="Arial" color="#0000FF" size="3">Joint&nbsp;Specification</font><font face="Arial" color="#0000FF" size="3"><u></a></u></font><font face="Arial" color="#000100" size="3"> in Appendix1). <br><br>The </font><font face="Arial" color="#000100" size="3"><strong><em>powered exponential function</em></strong></font><font face="Arial" color="#000100" size="3"> is implemented using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> distribution and has 2 parameters:<br></font><font face="Arial" color="#000100" size="3"><strong><em>phi</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the rate of decline of correlation with distance between points. </font><font face="Arial" color="#000100" size="3"><em>Note that the magnitude of this parameter will depend on the units in which the x and y coordinates of each location are measured (e.g. metres, km etc.). </em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><strong><em>kappa</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter controlling the amount of spatial smoothing. This is constrained to lie in the interval [0, 2). <br><br>The </font><font face="Arial" color="#000100" size="3"><strong><em>disc function</em></strong></font><font face="Arial" color="#000100" size="3"> is implemented using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> distribution and has 1 parameter:<br></font><font face="Arial" color="#000100" size="3"><strong><em>alpha</em></strong></font><font face="Arial" color="#000100" size="3"> : A scalar parameter representing the radius of the 'disc' centred at each (x, y) location. </font><font face="Arial" color="#000100" size="3"><em>Note that the magnitude of this parameter will depend on the units in which the x and y coordinates of each location are measured (e.g. metres, km etc.). </em></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="3"><strong>Warning:</strong></font><font face="Arial" color="#000100" size="3"> These models can be very </font><font face="Arial" color="#FF0000" size="3"><em>slow</em></font><font face="Arial" color="#000100" size="3"> for even moderate sized datasets (the algorithm is of order N</font><font face="Arial" color="#000100" size="2"><sup>3</sup></font><font face="Arial" color="#000100" size="3">)! Experience to date also suggests that it may be better to </font><font face="Arial" color="#FF0000" size="3"><em>hierarchically centre</em></font><font face="Arial" color="#000100" size="3"> this model. For example, consider the following two alternative parameterisations of the same model:</font><font face="Courier New" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="3"><br>Non-hierarchically centred<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dnorm(S[i], gamma) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i] &lt;- alpha+beta*z[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi,1)</font><font face="Arial" color="#000100" size="3"><br><br>Hierarchically centred <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dnorm(S[i], gamma) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[i] &lt;- alpha+beta*z[i] + W[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i]&lt;-0<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">W[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi,1)</font><font face="Arial" color="#000100" size="3"><br><br>In some simulated examples, the non-hierarchically centred parameterisation has produced incorrect results, while the hierarchically centred parameterisation gives sensible answers. This may be a feature of the single-site updating schemes used in WinBUGS, so interpret your results with care!<br>(Thanks to Alan Gelfand, Shanshan Wu and Alex Schmidt for noting this problem).<br><br>Experience also suggests that there is often very little information in the data about the values of the parameters of the powered exponential (i.e. phi and kappa) or disc (i.e. alpha) functions. We therefore recommend that reasonably informative priors are used, or that the values are fixed a priori, based on either substantive knowledge or exploratory analysis using e.g. variograms. <br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="spatial.exp.pred"></strong></font><font face="Courier New" color="#000100" size="6">spatial.pred and spatial.unipred</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Spatial interpolation or prediction at arbitrary locations can be carried out using the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.pred</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.unipred</em></strong></font><font face="Arial" color="#000100" size="3"> functions, in conjunction with fitting either the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> model to a set of observed data. </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.pred</em></strong></font><font face="Arial" color="#000100" size="3"> carries out joint or simultaneous prediction at a set of target locations, whereas </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.unipred</em></strong></font><font face="Arial" color="#000100" size="3"> carries out single site prediction. The difference is that the single site prediction yields marginal prediction intervals (i.e. ignoring correlation between prediction locations) whereas joint prediction yields simultaneous prediction intervals for the set of target locations (which will tend to be narrower than the marginal prediction intervals). The predicted means should be the same under joint or single site prediction. The disadvantage of joint prediction is that it is very slow (the computational time is of order P</font><font face="Arial" color="#000100" size="2"><sup>3</sup></font><font face="Arial" color="#000100" size="3">, where P is the number of prediction sites). The syntax for these predictive distributions is:<br><br>Joint prediction:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">T[1:P] ~ spatial.pred(mu.T[], x.T[], y.T[], S[])<br><br>Single site prediction:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:P) {<br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">T[j] ~ spatial.unipred(mu.T[j], x.T[j], y.T[j], S[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>P</em></strong></font><font face="Arial" color="#000100" size="3"> : Scalar giving the number of prediction locations<br></font><font face="Arial" color="#000100" size="3"><strong><em>mu.T[]</em></strong></font><font face="Arial" color="#000100" size="3"> : vector of length P (or scalar for single site version) specifying the mean for each prediction location (this should be specified in the same way as the mean for the observed data S).<br></font><font face="Arial" color="#000100" size="3"><strong><em>x.T[] </em></strong></font><font face="Arial" color="#000100" size="3">and </font><font face="Arial" color="#000100" size="3"><strong><em>y.T[] </em></strong></font><font face="Arial" color="#000100" size="3">: Vectors of length P (or scalars for single site version) giving the x and y coordinates of the location of each prediction point<br></font><font face="Arial" color="#000100" size="3"><strong><em>S</em></strong></font><font face="Arial" color="#000100" size="3"> : The vector of observations to which either the </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.exp</em></strong></font><font face="Arial" color="#000100" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em>spatial.disc</em></strong></font><font face="Arial" color="#000100" size="3"> model has been fitted.<br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="pois.conv"></strong></font><font face="Courier New" color="#000100" size="6">pois.conv</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>A conjugate Poisson-gamma spatial moving average distribution can be specified for non-negative counts defined on a spatial lattice (i.e. discrete geographical partition), using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>pois.conv</em></strong></font><font face="Arial" color="#000100" size="3">. This is a discrete version of the Poisson-gamma random field model of Wolpert and Ickstadt (1998) and Best et al (2000a). The basic syntax for this distribution is as follows: </font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S ~ dpois.conv(mu[])&nbsp;&nbsp;&nbsp;<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>S</em></strong></font><font face="Arial" color="#000100" size="3"> is a non-negative </font><font face="Arial" color="#000100" size="3"><em>scalar</em></font><font face="Arial" color="#000100" size="3"> parameter defined at some (usually spatial) location, and </font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> is a </font><font face="Arial" color="#000100" size="3"><em>vector </em></font><font face="Arial" color="#000100" size="3">of length J representing the influence of a set of gamma distributed latent parameters at each of J different locations on the value of S. Hence </font><font face="Arial" color="#000100" size="3"><strong><em>mu[]</em></strong></font><font face="Arial" color="#000100" size="3"> must be defined as a convolution of gamma random variables:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (j in 1 : J) { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[j] &lt;- gamma[j] * k[j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">gamma[j] </font><font face="Arial" color="#000100" size="3">~ dgamma(a, b)</font><font face="Arial" color="#000000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="3"><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>k[j]</em></strong></font><font face="Arial" color="#000100" size="3"> is a spatial kernel or spatial 'weight' depending on some measure of distance or spatial proximity between the jth latent location and the location of S, and </font><font face="Arial" color="#000100" size="3"><strong><em>a</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>b</em></strong></font><font face="Arial" color="#000100" size="3"> are hyperparameters to be specified (see </font><font face="Arial" color="#000100" size="3"><a href="#Appendix 2"></font><font face="Arial" color="#0000FF" size="3">Appendix&nbsp;2</font><font face="Arial" color="#000100" size="3"></a> for further discussion of this distribution, including suitable kernel functions). Usually, </font><font face="Arial" color="#000100" size="3"><strong><em>k[]</em></strong></font><font face="Arial" color="#000100" size="3"> is calculated externally and read into WinBUGS as data; alternatively, if k[] depends on unknown parameters, it may be defined as part of the BUGS code and re-computed at each MCMC iteration. However, this is likely to slow down the sampling within WinBUGS by many orders of magnitude, so is not recommended for models with large numbers of latent parameters (i.e. J large).<br><br>More typically, the distribution will be used for each element of a </font><font face="Arial" color="#000100" size="3"><em>vector</em></font><font face="Arial" color="#000100" size="3"> of counts defined on a spatial lattice of N regions, using the following syntax:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[i] ~ dpois.conv(mu[i, ])&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (j in 1 : J) { </font><font face="Arial" color="#00FF00" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;mu[i, j] &lt;- gamma[j] * k[i, j]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>where the latent gamma[j] parameters are defined as above, and k[,] is now an N x J matrix with elements k[i,j] representing the 'weight' or contribution of the latent gamma random variable at location j to the expected value of S at location i. <br><br>Conditional on mu, the S[i] have independent Poisson distributions with mean = </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="3"><sub>j </sub></font><font face="Arial" color="#000100" size="3">mu[i, j]. <br><br>Note that the model may be extended to include observed covariates as well as latent variables in the Poisson mean - see </font><font face="Arial" color="#0000FF" size="3"><a href="../GeoBUGS/Examples/MVCAR.html">MVCAR Example</a>.</font><font face="Arial" color="#000100" size="3"><br><br><br>&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong><a id="mv.car"></strong></font><font face="Courier New" color="#000100" size="6">mv.car</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>The multivariate intrinsic Gaussian CAR prior distribution is specified using the distribution </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> for the p x N </font><font face="Arial" color="#000100" size="3"><em>matrix </em></font><font face="Arial" color="#000100" size="3">of random varables </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> , where columns of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> represent the spatial units (areas) and rows represent the variables (it is important to ensure the dimensions of S are specified the correct way round). The syntax for this distribution is as follows:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S[1:p, 1:N] ~ mv.car(adj[], weights[], num[], omega[ , ])<br><br>where:<br><br></font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector listing the ID numbers of the adjacent areas for each area (this is a sparse representation of the full adjacency matrix for the study region, and can be generated using the </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool </em></strong></font><font face="Arial" color="#000100" size="3">from the </font><font face="Arial" color="#000100" size="3"><strong><em>Map</em></strong></font><font face="Arial" color="#000100" size="3"> menu in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3"> : A vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj[] </em></strong></font><font face="Arial" color="#000100" size="3">giving </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights associated with each pair of areas. For the CAR model described above, taking C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 (equivalently W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/ n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ) if areas i and j are neighbours and 0 otherwise, gives a vector of 1's for </font><font face="Arial" color="#000100" size="3"><strong><em>weights[]</em></strong></font><font face="Arial" color="#000100" size="3">.<br></font><font face="Arial" color="#000100" size="3"><strong><em>num[] </em></strong></font><font face="Arial" color="#000100" size="3">: A vector of length N (the total number of areas) giving the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for each area.<br></font><font face="Arial" color="#000100" size="3"><strong><em>omega[ , ]</em></strong></font><font face="Arial" color="#000100" size="3"> : A p x p matrix representing the precision (inverse variance) matrix of the multivariate intrinsic Gaussian CAR prior.<br><br>The first 3 arguments must be entered as data (it is currently not possible to allow the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> to be unknown); the final variable </font><font face="Arial" color="#000100" size="3"><strong><em>omega</em></strong></font><font face="Arial" color="#000100" size="3"> is usually treated as unknown and so is assigned a prior distribution (which must be a Wishart distribution). The data variables </font><font face="Arial" color="#000100" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">may be created by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> as described <a href="#Adj"></font><font face="Arial" color="#0000FF" size="3">above</font><font face="Arial" color="#000100" size="3"></a>. The variable</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"> must be created by the user, and must be a vector the same length as </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3">. A common choice is to set all the </font><font face="Arial" color="#000100" size="3"><strong><em>weights</em></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">equal to 1 since this gives the multivariate equivalent of the standard Besag, York and Mollie (1991) CAR model (see sections on <a href="#Intrinsic"></font><font face="Arial" color="#0000FF" size="3">intrinsic&nbsp;CAR&nbsp;models</font><font face="Arial" color="#000100" size="3"></a> and <a href="#MV"></font><font face="Arial" color="#0000FF" size="3">multivariate&nbsp;intrinsic&nbsp;CAR&nbsp;models</font><font face="Arial" color="#000100" size="3"></a> in Appendix 1 for further discussion of weights). The easiest way to do this is to create a loop in your </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> model code:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:sumNumNneigh) { weights[j] &lt;- 1}<br><br>where </font><font face="Arial" color="#000100" size="3"><strong><em>sumNumNneigh</em></strong></font><font face="Arial" color="#000100" size="3"> is the length of </font><font face="Arial" color="#000100" size="3"><strong><em>adj </em></strong></font><font face="Arial" color="#000100" size="3">and is also output by the </font><font face="Arial" color="#000100" size="3"><strong><em>adj matrix</em></strong></font><font face="Arial" color="#000100" size="3"> option of the </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS </em></font><font face="Arial" color="#000100" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000100" size="3"> .<br><br>Important things to check when using the </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution:<br><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The</font><font face="Arial" color="#000100" size="3"><strong><em> mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution uses </font><font face="Arial" color="#FF0000" size="3">unnormalised</font><font face="Arial" color="#000100" size="3"> weights, as for the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> distribtion.<br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#FF0000" size="3">An area cannot be specified as its own neighbour</font><font face="Arial" color="#000100" size="3"> so make sure the ID number of the area itself does not appear in as one of its list of neighbours in the </font><font face="Arial" color="#000100" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000100" size="3"> vector. </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> does </font><font face="Arial" color="#000100" size="3"><em>not</em></font><font face="Arial" color="#000100" size="3"> check for this, so it is the user's responsibility. <br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The weights must be </font><font face="Arial" color="#FF0000" size="3">symmetric</font><font face="Arial" color="#000100" size="3"> ( W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>ji</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">). </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><em>does</em></font><font face="Arial" color="#000100" size="3"> carry out a check for this and returns an error message if non-symmetric weights are detected.<br></font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Take care with priors on </font><font face="Arial" color="#000100" size="3"><strong><em>omega</em></strong></font><font face="Arial" color="#000100" size="3">, and be prepared to carry out sensitivity analysis to this choice.<br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> The </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> distribution is parameterised to include a </font><font face="Arial" color="#FF0000" size="3">sum-to-zero constraint</font><font face="Arial" color="#000100" size="3"> on the random effects. This means that you must also include </font><font face="Arial" color="#FF0000" size="3">separate intercept </font><font face="Arial" color="#000100" size="3">terms in your model for each of the p variables, which MUST be assigned improper uniform priors using the </font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> distribution. </font><font face="Arial" color="#000100" size="3"><em>Note: the mechanism for implementing the sum-to-zero constraint for mv.car in WinBUGS has been tested and appears to be robust; however, we recommend that you nevertheless include a check in your model code to ensure that the constraint has been implemented correctly (e.g. by including a line in your code to calculate the mean across areas of each variable for which the mv.car prior has been assumed). Please report any problems to n.best@imperial.ac.uk. </em></font><font face="Arial" color="#000100" size="3"><br></font><font face="Symbol" color="#000100" size="3"><strong>*</strong></font><font face="Arial" color="#000100" size="3"> An alternative </font><font face="Arial" color="#FF0000" size="3">unconstrained</font><font face="Arial" color="#000100" size="3"> version of the multivariate CAR prior is available in WinBUGS 1.4, called </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car.uncon</em></strong></font><font face="Arial" color="#000100" size="3">. The syntax is the same as for mv.car. <br></font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Because the </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car</em></strong></font><font face="Arial" color="#000100" size="3"> (and </font><font face="Arial" color="#000100" size="3"><strong><em>mv.car.uncon</em></strong></font><font face="Arial" color="#000100" size="3">) distribution is improper, it can only be used as a </font><font face="Arial" color="#FF0000" size="3">prior</font><font face="Arial" color="#000100" size="3"> distribution, and not as a likelihood. <br><br><br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Temporal"></strong></font><font face="Courier New" color="#000100" size="6">Temporal distributions</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Courier New" color="#000100" size="6"> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="5"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><strong><a id="rw"></strong></font><font face="Arial" color="#FF0000" size="3"><strong><em>&nbsp;&nbsp;&nbsp;</em></strong></font><font face="Arial" color="#000100" size="3"><strong><em>Using car.normal as a random walk prior for temporal smoothing</em></strong></font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>In one dimension, the intrinsic Gaussian CAR distribution reduces to a Gaussian random walk (see e.g.Fahrmeir and Lang, 2001). Assume we have a set of temporally correlated random effects </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">, t=1,..., T (where T is the number of equally-spaced time points). In the simplest case of a random walk of order 1, RW(1), we may write<br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/2, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 2 ) for t = 2, ...., T-1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>where </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denotes all elements of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">except the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">. This is equivalent to specifying <br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( S</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Symbol" color="#000100" size="3"> q</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3">) for t = 1, ..., T<br><br>where C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> / W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">, W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> and W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 1 if k = (t-1) or (t+1) and 0 otherwise; M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3"> = 1/W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">. Hence the RW(1) prior may be fitted using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution in WinBUGS, with appropriate specification of the weight and adjacency matrices, and num vector (see the</font><font face="Arial" color="#0000FF" size="3"> <a href="../GeoBUGS/Examples/Pollution.html">Air Pollution Example</font><font face="Arial" color="#000100" size="3"></a>) </font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3"><br>A second order random walk prior is defined as<br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">(2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">)/5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = 2 <br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">)/6, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 6 ) for t = 3, ...., T-2<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ 4q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = T-1<br>~ Normal </font><font face="Symbol" color="#000100" size="3">( -q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>Again this is equivalent to specifying <br><br></font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( S</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"> C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Symbol" color="#000100" size="3"> q</font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3">) for t = 1, ..., T<br><br>where C</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> is defined as above, but this time with W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">1 if k = (t-2) or (t+2), W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 4 if k = (t-1) or (t+1) and t in (3, T-2), W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 2 if k = (t-1) or (t+1) and t = 2 or T-1, W</font><font face="Arial" color="#000100" size="2"><sub>tk</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise; M</font><font face="Arial" color="#000100" size="2"><sub>tt</sub></font><font face="Arial" color="#000100" size="3"> = 1/W</font><font face="Arial" color="#000100" size="2"><sub>t+</sub></font><font face="Arial" color="#000100" size="3">. <br><br>Note that if the observed time points are not equally spaced, it is necessary to include missing values (NA) for the intermediate time points (see the </font><font face="Arial" color="#0000FF" size="3"><a href="../GeoBUGS/Examples/Pollution.html">Air Pollution Example</font><font face="Arial" color="#000100" size="3"></a></a>). <br><br></font><font face="Arial" color="#0000FF" size="2"><u><br></u></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><a id="Appendix"></font><font face="Courier New" color="#000100" size="6">Appendix 1: Technical details of Structured Multivariate Gaussian and Conditional Autoregressive (CAR) models and hyperprior specification</font><font face="Arial" color="#000100" size="3">.</a></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br>(Note: for clarity of exposition, we parameterise the Normal distribution in terms of the mean and </font><font face="Arial" color="#000100" size="3"><em>variance</em></font><font face="Arial" color="#000100" size="3"> in the following discussion. However, </font><font face="Arial" color="#000100" size="3"><em>WinBUGS</em></font><font face="Arial" color="#000100" size="3"> parameterisation of the CAR and structured MVN models is in terms of the mean and precision as usual.)<br><br>Assume we have a set of area-specific spatially correlated Gaussian data or random effects S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, i=1,..., N (where N is the number of areas in the study region). Suppose their joint distribution may be expressed as follows: <br><br></font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> ~ MVN(</font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3">, v</font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3">) <br><br>where </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = ( S</font><font face="Arial" color="#000100" size="3"><sub>1</sub></font><font face="Arial" color="#000100" size="3">, ....., S</font><font face="Arial" color="#000100" size="3"><sub>N </sub></font><font face="Arial" color="#000100" size="3">), MVN denotes the N-dimensional multivariate normal distribution, </font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"> is the 1 x N mean vector, v &gt; 0 controls the overall variability of the S</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is an N x N positive definite matrix. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Joint"></strong></font><font face="Courier New" color="#000100" size="6">Joint specification</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#000100" size="3">[<a href="#Top"></font><font face="Arial" color="#0000FF" size="3">top</a></font><font face="Arial" color="#000100" size="3">]</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>We may assume a parametric form for the elements of the between-area correlation matrix:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> &nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3">)<br>where d</font><font face="Arial" color="#000100" size="3"><sub>ij </sub></font><font face="Arial" color="#000100" size="3">= distance between areas i and j. WinBUGS 1.4 allows two options for the funtion f(.) (see Richardson (1992) for further details of these functions):<br><br></font><font face="Arial" color="#000100" size="3"><strong>1. Powered exponential family<br></strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">f, k</font><font face="Arial" color="#000100" size="3">) = exp[</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">(</font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Symbol" color="#000100" size="2"><sup>k</sup></font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">] where </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">&gt; 0, </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> in (0, 2]<br><br>The parameter </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> controls the rate of decline of correlation with distance:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> large </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; rapid decay<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3">small </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; slow decay<br><br>One possible strategy for specifying a prior for </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> is to choose a uniform distribution between </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> where </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> are chosen to give a sensible range of values for correlations both at a distance equal to the </font><font face="Arial" color="#000100" size="3"><em>maximum</em></font><font face="Arial" color="#000100" size="3"> distance between any pair of areas in the study region, and at a distance equal to the </font><font face="Arial" color="#000100" size="3"><em>minimum</em></font><font face="Arial" color="#000100" size="3"> distance between any pair of areas in the study. For example, if the minimum distance is 1 km (say), and the maximum distance is 20 km (say), then values of </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">= 0.04 and </font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"> = 5 would give a diffuse but plausible prior range of correlations (assuming </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 1</font><font face="Symbol" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="3"> between 0.007 and 0.96 at a distance of 1 km, and between 0 and 0.45 at a distance of 20 km. </font><font face="Arial" color="#000100" size="3"><em>Note that it is advisable to choose a value of </em></font><font face="Arial" color="#000100" size="3"></font><font face="Symbol" color="#000100" size="3">f </font><font face="Arial" color="#000100" size="3"><sub>min </sub></font><font face="Arial" color="#000100" size="3"><em>that prevents the correlation at the maximum distance between observations in the study region from being too high, since this can lead to identifiability problems between the overall mean, </em></font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"><em>, of the spatial random variables and the correlation parameter, </em></font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"><em>.</em></font><font face="Arial" color="#000100" size="3"><br><br>The parameter </font><font face="Symbol" color="#000100" size="3">k </font><font face="Arial" color="#000100" size="3">controls the amount by which spatial variations in the data are smoothed. Large values of </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> lead to greater smoothing, with </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 2 corresponding to the Gaussian correlation function (although the resulting covariance matrix is nearly singular). It is often difficult to learn much about this parameter, so unless there is a good reason for believing otherwise, it is usually advisable to set </font><font face="Symbol" color="#000100" size="3">k</font><font face="Arial" color="#000100" size="3"> = 1 a priori. <br><br></font><font face="Arial" color="#000100" size="3"><strong>2. Disc model<br></strong></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">; </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 2 / </font><font face="Symbol" color="#000100" size="3">p</font><font face="Arial" color="#000100" size="3"> * {cos</font><font face="Symbol" color="#000100" size="2"><sup>-</sup></font><font face="Arial" color="#000100" size="2"><sup>1</sup></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Symbol" color="#000100" size="3">-</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">[(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">)(1 </font><font face="Symbol" color="#000100" size="3">-</font><font face="Symbol" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">(d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">/</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">))]</font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> }&nbsp;&nbsp;&nbsp;for d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">&lt; a</font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0&nbsp;&nbsp;&nbsp;for d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">&gt; a</font><font face="Arial" color="#000100" size="3"><br><br>The parameter </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> controls the rate of decline of correlation with distance:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"> large </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; slow decay<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">a </font><font face="Arial" color="#000100" size="3">small </font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">&gt; rapid decay<br><br>The disc function leads to an approximately linear decrease in correlation with increasing distance, with correlation declining to zero at a distance equal to </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3">. </font><font face="Arial" color="#000100" size="3"><em>Again, it is advisable to choose a prior for </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><em>that prevents the correlation at the maximum distance between observations in the study region from being too high, since this can lead to identifiability problems between the overall mean, </em></font><font face="Symbol" color="#000100" size="3"><strong>m</strong></font><font face="Arial" color="#000100" size="3"><em>, of the spatial random variables and the correlation parameter,</em></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em>. An upper prior bound on </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> equal to a small multiple of the maximum distance in the study region is therefore a sensible 'default' choice. The minimum value allowed a priori for </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> should also be chosen carefully since values of </em></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><em> less than the minimum distance between observations in the study region will not be identifiable.<br></em></font><font face="Arial" color="#000100" size="3"><br>Exploratory analysis using variograms maybe be helpful to help chose an appropriate specification for the correlation function and associated parameters. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Conditional">Conditional specification</a></strong></font><font face="Arial" color="#000100" size="5"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>] </font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>By writing the between-area covariance matrix in the following form:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v</font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> = v(</font><font face="Arial" color="#000100" size="3"><strong>I</strong></font><font face="Arial" color="#000100" size="3"> - </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M<br><br></strong></font><font face="Arial" color="#000100" size="3">where </font><font face="Arial" color="#000100" size="3"><strong>I </strong></font><font face="Arial" color="#000100" size="3">= N x N identity matrix<br></font><font face="Arial" color="#000100" size="3"><strong>M </strong></font><font face="Arial" color="#000100" size="3">= N x N diagonal matrix, with elements M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> proportional to the conditional variance of S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> <br></font><font face="Arial" color="#000100" size="3"><strong>C </strong></font><font face="Arial" color="#000100" size="3">= N x N weight matrix, with elements C</font><font face="Arial" color="#000100" size="3"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> reflecting spatial association between areas i and j<br></font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3">= controls overall strength of spatial dependence<br><br>and using standard multivariate normal theory (e.g. Johnson and Kotz, 1972; Besag and Kooperberg, 1995), the joint multivariate Gaussian model can be expressed in the form of a set of conditional distributions<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal (</font><font face="Symbol" color="#000100" size="3">m </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3">C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> (s</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">-m</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">), </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> ), <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(here </font><font face="Symbol" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> denotes summation over j = 1 to N, not covariance matrix, and </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes all the elements of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> except S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>From a modelling perspective, use of the joint formulation requires specification of the elements of the covariance matrix </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> (see above), while use of the conditional formulation reduces to specification of the matrices </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> and the spatial dependence parameter </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3">. Various constraints are needed on the values of </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> in order to ensure that </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is symmetric positive definite:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* S</strong></font><font face="Arial" color="#000100" size="3"> is only symmetric if C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>jj</sub></font><font face="Arial" color="#000100" size="3"> = C</font><font face="Arial" color="#000100" size="2"><sub>ji</sub></font><font face="Arial" color="#000100" size="3"> M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong>* </strong></font><font face="Arial" color="#000100" size="3">Var( S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) = vM</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> &gt; 0 so M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> must be &gt; 0</font><font face="Symbol" color="#000100" size="3"><strong><br>&nbsp;&nbsp;&nbsp;* </strong></font><font face="Arial" color="#000100" size="3">To ensure S is positive definite, </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> must lie between </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>min </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>max </sub></font><font face="Arial" color="#000100" size="3">where </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>min</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;g </font><font face="Arial" color="#000100" size="3"><sub>max</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are the smallest and largest eigenvalues of </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>-1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3"><strong><br>&nbsp;&nbsp;&nbsp;* </strong></font><font face="Arial" color="#000100" size="3">In practice, we often expect positive spatial dependence, so constrain prior for </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> to be between 0 and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="3"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><br></font><font face="Symbol" color="#000100" size="3"><strong>&nbsp;&nbsp;&nbsp;*</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> = 0 implies no spatial dependence</font><font face="Arial" color="#000100" size="3"><sub><br><br></sub></font><font face="Arial" color="#000100" size="3"><strong><a id="Intrinsic"></strong></font><font face="Courier New" color="#000100" size="6">Intrinsic CAR model</font><font face="Arial" color="#000100" size="3"><strong></a></strong></font><font face="Courier New" color="#000100" size="6"> </font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><strong><sub><br></sub></strong></font><font face="Arial" color="#000100" size="3"><br>Besag, York and Mollie (1991) propose an intrinsic version of this CAR model in which the covariance matrix </font><font face="Symbol" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> is not positive definite. Their model corresponds to choosing C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> if areas i and j are adjacent and C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise (with C</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> also set to 0), M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, and setting </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">which turns out to always be 1 with this particular choice of C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> and M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3">. Here, n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the number of areas which are adjacent to area i. Comparison with the equations above shows that this leads to the following model for the conditional distribution of S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> :<br><br>S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Normal ( S.bar</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, v / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">)<br><br>where S.bar</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> in </sub></font><font face="Symbol" color="#000100" size="3"><sub>d</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> denotes the set of labels of the &quot;neighbours&quot; of area i. Hence S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> has a normal distribution with conditional mean given by the average of the neighbouring S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">'s and conditional variance inversely proportional to the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> . Note that an equivalent specification is take </font><font face="Arial" color="#000100" size="3"><em>unnormalised </em></font><font face="Arial" color="#000100" size="3">weights W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1 if areas i and j are adjacent and W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise, and set C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> / W</font><font face="Arial" color="#000100" size="2"><sub>i+</sub></font><font face="Arial" color="#000100" size="3"> where W</font><font face="Arial" color="#000100" size="2"><sub>i+</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> W</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">. The </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> and (</font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3">) distributions in </font><font face="Arial" color="#000100" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000100" size="3"> requires the user to specify </font><font face="Arial" color="#000100" size="3"><em>unnormalised weights</em></font><font face="Arial" color="#000100" size="3">.<br><br>Since the CAR model defined above is improper (the overall mean of the S</font><font face="Arial" color="#000100" size="3"><sub>i </sub></font><font face="Arial" color="#000100" size="3">is not defined), it can only be used as a prior distribution for spatially distributed random effects, and not as a likelihood for data. It is often convenient to assume that suchrandom effects have zero mean. Besag and Kooperberg (1995) show that constraining the random effects to sum to zero and specifying a separate intercept term with a location invariant Uniform(-infty, +infty) prior is equivalent to the unconstrained parameterisation with no separate intercept. WinBUGS 1.4 includes a distribution called </font><font face="Arial" color="#000100" size="3"><strong><em>dflat()</em></strong></font><font face="Arial" color="#000100" size="3"> which corresponds to an improper (flat) prior on the whole real line. This prior must always be used for the intercept term in a model including CAR random effects.<br><br>We must also specify prior distributions for the overall variance parameter v. As usual in WinBUGS, the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000100" size="3"> (and </font><font face="Arial" color="#000100" size="3"><strong><em>car.l1</em></strong></font><font face="Arial" color="#000100" size="3">) distributions are parameterised in terms of the precision </font><font face="Symbol" color="#000100" size="3">t </font><font face="Arial" color="#000100" size="3">= 1/</font><font face="Arial" color="#000100" size="3">v</font><font face="Symbol" color="#000100" size="3"> . </font><font face="Arial" color="#000100" size="3">Care is needed when choosing a prior for</font><font face="Symbol" color="#000100" size="3"> t</font><font face="Arial" color="#000100" size="3"> since the posterior variance of the random effects can be quite sensitive. One option is a gamma</font><font face="Arial" color="#000100" size="3"> distribution with shape and inverse scale parameters both equal to 0.01. This has a mean of 0.01/0.01 = 1 and a large variance of 0.01/(0.01)</font><font face="Arial" color="#000100" size="3"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> = 100; however, this tends to place most of the prior mass away from zero (on the scale of the random effects standard deviation), and so in situations when the true spatial dependence between areas is negligible (i.e. standard deviation close to zero) this may induce artefactual spatial structure in the posterior. Kelsall and Wakefield (1999) suggest an alternative gamma(0.5, 0.0005) prior for the precision parameter of the spatial random effects in a CAR model. This expresses the prior belief that the random effects standard deviation is centered around 0.05 with a 1% prior probability of being smaller than 0.01 or larger than 2.5. <br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="Proper"></strong></font><font face="Courier New" color="#000100" size="6">Proper CAR model</font><font face="Arial" color="#000100" size="3"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><br><br>If </font><font face="Symbol" color="#000100" size="3">g</font><font face="Arial" color="#000100" size="3"> is constrained to lie in the interval (</font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) where </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>min</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"> and </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>max</sub></font><font face="Arial" color="#000100" size="2"><sup>-1</sup></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are the smallest and largest eigenvalues of </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>-1/2</sup></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"> as defined above, rather than being fixed to its maximum as in the intrinsic CAR, then the resulting distribution is proper provided the constraints on </font><font face="Arial" color="#000100" size="3"><strong>C</strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong>M</strong></font><font face="Arial" color="#000100" size="3"> are still satisfied. The choice C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> if areas i and j are adjacent and C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = 0 otherwise (with C</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> also set to 0) and M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, where n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is the number of areas which are adjacent to area i is still valid for the proper CAR. In the context of disease mapping Cressie and Chan (1989) and Stern and Cressie (1999) choose an alternative parameterisation:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;M</font><font face="Arial" color="#000100" size="2"><sub>ii</sub></font><font face="Arial" color="#000100" size="3"> = 1/E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> (the inverse of the expected count or population size in area i)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;C</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> = (E</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> / E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)</font><font face="Arial" color="#000100" size="2"><sup>1/2</sup></font><font face="Arial" color="#000100" size="3"><sup> </sup></font><font face="Arial" color="#000100" size="3">for neighbouring areas i, j and 0 otherwise<br><br></font><font face="Arial" color="#000100" size="3"><strong><a id="MV"></strong></font><font face="Courier New" color="#000100" size="6">Multivariate intrinsic CAR model</font><font face="Arial" color="#000100" size="3"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><br><br>Assume we have a multivariate p-dimensional vector of spatially correlated Gaussian data or random effects in each area, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = (S</font><font face="Arial" color="#000100" size="2"><sub>1i</sub></font><font face="Arial" color="#000100" size="3"> , S</font><font face="Arial" color="#000100" size="2"><sub>2i</sub></font><font face="Arial" color="#000100" size="3">,....., S</font><font face="Arial" color="#000100" size="2"><sub>pi</sub></font><font face="Arial" color="#000100" size="3"> )', i=1,..., N. The CAR models discussed above extend naturally to a multivariate setting by replacing the univariate Gaussian conditional distribution for S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | S</font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="3">with a multivariate conditional distribution. In the case of the intrinsic CAR prior with 0-1 adjacency weights as used by Besag, York and Mollie (1991), and taking the case of p = 2 for simplicity, this gives:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | (</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>1(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>2(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">) ~ Bivariate Normal (</font><font face="Arial" color="#000100" size="3"><strong>S.bar</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>V</strong></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">), <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(here (</font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>1(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>2(</sub></font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>i)</sub></font><font face="Arial" color="#000100" size="3">) denotes the elements of the 2 x N matrix S excluding the ith area (column))<br><br>where </font><font face="Arial" color="#000100" size="3"><strong>S.bar</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">(</font><font face="Arial" color="#000100" size="3">S.bar</font><font face="Arial" color="#000100" size="2"><sub>i1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">,</font><font face="Symbol" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#000100" size="3">S.bar</font><font face="Arial" color="#000100" size="2"><sub>i2</sub></font><font face="Arial" color="#000100" size="3">) with S.bar</font><font face="Arial" color="#000100" size="2"><sub>ip</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>j in </sub></font><font face="Symbol" color="#000100" size="2"><sub>d</sub></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">S</font><font face="Arial" color="#000100" size="2"><sub>jp</sub></font><font face="Arial" color="#000100" size="3"> / n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">and, as in the univariate case, </font><font face="Symbol" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denote the set of labels of the &quot;neighbours&quot; of area i and the number of neighbours, respectively. </font><font face="Arial" color="#000100" size="3"><strong>V</strong></font><font face="Arial" color="#000100" size="3"> is a 2 x 2 covariance matix with diagonal elements v</font><font face="Arial" color="#000100" size="2"><sub>11</sub></font><font face="Arial" color="#000100" size="3"> and v</font><font face="Arial" color="#000100" size="2"><sub>22</sub></font><font face="Arial" color="#000100" size="3"> representing the conditional variances of S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and S</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">respectively, and off-diagonal element v</font><font face="Arial" color="#000100" size="2"><sub>12</sub></font><font face="Arial" color="#000100" size="3"> representing the (conditional) within-area covariance between S</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and S</font><font face="Arial" color="#000100" size="2"><sub>2</sub></font><font face="Arial" color="#000100" size="3">. In general </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> has a p-dimensional multivariate normal distribution with pth element of the conditional mean vector given by the average of the neighbouring S</font><font face="Arial" color="#000100" size="2"><sub>jp</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">'s and conditional covariance matrix inversely proportional to the number of neighbours n</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, with pth diagonal element representing the conditional variance of the pth component of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3"> and off-diagonal elements representing the conditional covariances between each pair of the p elements of </font><font face="Arial" color="#000100" size="3"><strong>S</strong></font><font face="Arial" color="#000100" size="3">. <br><br>Gelfand and Vounatsou (2003) discuss a multivariate generalisation of the proper version of CAR distribution, but only the improper intrinsic multivariate CAR is currently implemented in WinBUGS. <br><br><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Appendix 2"></strong></font><font face="Courier New" color="#000100" size="6">Appendix 2: Technical details of the Poisson-gamma Spatial Moving Average convolution model.</font><font face="Arial" color="#000100" size="5"><strong></a></strong></font><font face="Arial" color="#000100" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><br><br>Spatial moving average models are a flexible class of models that have been used to describe continuous spatial processes, particularly in geostatistical applications. Such models are constructed by integrating a simple two-dimensional random noise process (for example, a grid of iid Gaussian random variables) with a smoothing kernel that is a function of distance and, possibly, location. The kernel can be thought of as a device to `smear out' the random noise process in two-dimensional space to give a smooth surface.<br><br>Spatial moving average models have been developed primarily for continuous spatial processes and are currently not implementable in WinBUGS 1.4. However, Ickstadt and Wolpert (1998) and Best et al (2000b) proposed a discrete version of a gamma moving average process, for use in identity-link Poisson regression models. Suppose we have a set of area-specific spatially correlated Poisson count data (or random effects) S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, i=1,..., N (where N is the number of areas in the study region). Ickstadt and Wolpert (1998) and Best et al (2000b) model spatial dependence at the level of the Poisson mean, and assume that the counts S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> are conditionally independent given this mean:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Poisson( </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">) <br><br>The model for each </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is constructed by specifying an arbitrary grid of latent iid gamma random variables </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"> (j=1,...,J where J is the total number of grid cells defining the latent process) covering the study region. These are then convolved with a kernel matrix whose elements, k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">, represent the relative contribution of the latent variable in grid cell j to the Poisson mean in area i:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"><sub> </sub></font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>Best et al (2000b) assume an isotropic, stationary Gaussian kernel function (although other kernel forms are easily accommodated, such as an adjacency-based kernel - see the </font><font face="Arial" color="#0000FF" size="3"><a href="../GeoBUGS/Examples/Forest.html">'Forest Example'</a></font><font face="Arial" color="#000100" size="3">):<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> / (2</font><font face="Symbol" color="#000100" size="3">p r</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">) exp(</font><font face="Symbol" color="#000100" size="3">-</font><font face="Arial" color="#000100" size="3">d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"> / 2</font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">)<br><br>where </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="3"> can be thought of as a scale factor for the </font><font face="Symbol" color="#000100" size="3">l</font><font face="Arial" color="#000100" size="3">'s, d</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"> is the distance between the centroid of area i and the centroid of latent grid cell j, and </font><font face="Symbol" color="#000100" size="3">r</font><font face="Arial" color="#000100" size="3"> is the spatial range parameter governing how rapidly the influence of the latent gamma random variables on the area-specific Poisson means declines with distance. <br><br>One interpretation of Poisson-gamma moving average model is to view the gamma random variables as representing the location and magnitude of unmeasured risk factors, and the area-specific Poisson means </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">as representing the cumulative effect of these risk factors in each area, weighted by their distance from the area according to the kernel 'weights' k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">. <br><br>The model may be extended to include observed covariates and an offset adjustment (e.g. to account for different populations in different areas). Observed covariates are included as additive terms in the linear predictor </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">as in a standard identity link Poisson regression:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>where X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the value of the kth observed covariate in area i. Note that due to the identity link, all covariates and regression coefficients must take positive values, yielding an interpretation as additive excess risk factors. The latent terms </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">may then be thought of as a spatial (non-negative) random effect for area i. Adjustment for an offset - say the population living in each area, N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> - is easily achieved by setting </font><font face="Symbol" color="#000100" size="3"><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">X</font><font face="Arial" color="#000100" size="2"><sub>ik</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">+ </font><font face="Symbol" color="#000100" size="3">S</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>Note that Best et al (2004) discuss how to standardise the offset N</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for different age and sex distributions within each area in an epidemiological application of these models. <br><br>Estimation of the </font><font face="Arial" color="#000100" size="3"><strong><em>pois.conv</em></strong></font><font face="Arial" color="#000100" size="3"> distribution is carried out in WinBUGS 1.4 using a data augmentation scheme to exploit the Poisson-gamma conjugacy of the full conditionals for the </font><font face="Symbol" color="#000100" size="3">g </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">parameters (see Ickstadt and Wolpert (1998) and Best et al (2000b) for details). It is also a good idea to assume gamma prior distributions for any other uncertain parameters in the linear predictor </font><font face="Symbol" color="#000100" size="3">l</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> (e.g. the </font><font face="Symbol" color="#000100" size="3">b </font><font face="Arial" color="#000100" size="2"><sub>k</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">parameters above) to exploit this conjugacy, although it is possible to assume any suitable prior distribution with positive support for these other parameters. Hyperprior specification is discussed in detail by Ickstadt and Wolpert (1998) and Best et al (2000b). Note however that the prior shape (a) and precision (b) parameters of the latent gamma variables should be chosen such that </font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">has prior mean proportional to the area of the j</font><font face="Arial" color="#000100" size="2"><sup>th</sup></font><font face="Arial" color="#000100" size="3"> latent grid cell. This makes the model spatially extensible in the sense that any partition of the latent gamma random variables will lead to identical probability distributions for the kernel-weighted sums </font><font face="Symbol" color="#000100" size="3">S </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">g</font><font face="Symbol" color="#000100" size="2"> </font><font face="Arial" color="#000100" size="2"><sub>j</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">* k</font><font face="Arial" color="#000100" size="2"><sub>ij</sub></font><font face="Arial" color="#000100" size="3">.<br><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="5"><strong><a id="Refs"></strong></font><font face="Courier New" color="#000100" size="6">References</font><font face="Arial" color="#000100" size="5"><strong></a> </strong></font><font face="Arial" color="#0000FF" size="3">[<a href="#Top">top</a>]</font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br>Besag, J., York, J. and Mollie, A. (1991). Bayesian image restoration, with two applications in spatial statistics.</font><font face="Arial" color="#000100" size="2"><em> Annals of the Institute of Statistical Mathematics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>43</strong></font><font face="Arial" color="#000100" size="2">, 1--59, (With discussion).<br><br>Besag, J. and Kooperberg, C.L. (1995). On conditional and intrinsic autoregressions. </font><font face="Arial" color="#000100" size="2"><em>Biometrika</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>82</strong></font><font face="Arial" color="#000100" size="2">, 733--746.</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="2">Best, N.G., Richardson, S. and Thomson, A. (2004). A comparison of Bayesian spatial models for disease mapping. </font><font face="Arial" color="#000100" size="2"><em>Statistical Methods in Medical Research</em></font><font face="Arial" color="#000100" size="2"> (to appear).<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Best, N.G., Ickstadt, K.and Wolpert, R.L. and Briggs, D.J. (2000a). </font><font face="Arial" color="#000100" size="2"><em>Journal of the American Statistical Association</em></font><font face="Arial" color="#000100" size="2">,</font><font face="Arial" color="#000100" size="2"><strong> 95</strong></font><font face="Arial" color="#000100" size="2">, 1076-1088.<br><br>Best, N.G., Ickstadt, K., Wolpert, R.L. and Briggs, D.J. (2000b). Combining models of health and exposure data: the SAVIAH study. In </font><font face="Arial" color="#000100" size="2"><em>Spatial Epidemiology: Methods and Applications</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J.C. Wakefield, N.G. Best and D.J. Briggs (eds), Oxford: Oxford University Press, p. 393-414.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Clayton, D.G and Kaldor, J. (1987). Empirical Bayes estimates of age-standardized relative risks for use in disease mapping. </font><font face="Arial" color="#000100" size="2"><em>Biometrics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>43</strong></font><font face="Arial" color="#000100" size="2">, 671--681.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Cressie, N.A. and Chan, N.H. (1989). Spatial modeling of regional variables. </font><font face="Arial" color="#000100" size="2"><em>Journal of the American Statistical Association</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>84</strong></font><font face="Arial" color="#000100" size="2">, 393--401.</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2"><br>Diggle, P.J., Tawn, J.A. and Moyeed, R.A. (1998). Model-based geostatistics. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>47</strong></font><font face="Arial" color="#000100" size="2">, 299-350.<br><br>Fahrmeir, L. and Lang, S. (2001). Bayesian inference for generlaized additive mixed models based on Markov random field priors. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>50</strong></font><font face="Arial" color="#000100" size="2">, 201-220.<br><br>Gelfand, A. and Vounatsou, P. (2003). Proper multivariate conditional autoregressive models for spatial data analysis. </font><font face="Arial" color="#000100" size="2"><em>Biostatistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>4</strong></font><font face="Arial" color="#000100" size="2">, 11-25.<br><br>Ickstadt, K. and Wolpert, R.L. (1998). Multiresolution assessment of forest inhomogeneity. In </font><font face="Arial" color="#000100" size="2"><em>Case Studies in Bayesian Statistics, Volume 3. </em></font><font face="Arial" color="#000100" size="2">Lecture Notes in Statistics, </font><font face="Arial" color="#000100" size="2"><strong>121</strong></font><font face="Arial" color="#000100" size="2">. C. Gatsonis, J.S. Hodges, R.E. Kass, R. McCulloch, P. Rossi and N.D. Singpurwalla (eds), New York: Springer-Verlag, p. 371-386.<br><br>Johnson, N.L. and Kotz, S. (1972). </font><font face="Arial" color="#000100" size="2"><em>Distributions in Statistics: continuous multivariate</em></font><font face="Arial" color="#000100" size="2">. Wiley: New York.<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="2">Kelsall, J.E. and Wakefield, J.C. (1999). Discussion of &quot;Bayesian models for spatially correlated disease and exposure data&quot;, by Best </font><font face="Arial" color="#000100" size="2"><em>et al.</em></font><font face="Arial" color="#000100" size="2"> In</font><font face="Arial" color="#000100" size="2"><em> Bayesian Statistics 6</em></font><font face="Arial" color="#000100" size="2">. J.M. Bernardo, J.O. Berger, A.P. Dawid and A.F.M. Smith (eds), Oxford: Oxford University Press, p. 151.<br><br>Knorr-Held L. and Best N.G. (2001). A shared component model for joint and selective clustering of two diseases. </font><font face="Arial" color="#000100" size="2"><em>Journal of the Royal Statistical Society, Series A</em></font><font face="Arial" color="#000100" size="2">. </font><font face="Arial" color="#FF00FF" size="2"><br></font><font face="Arial" color="#000100" size="2"><br>Mollie, A. (1996). Bayesian mapping of disease. In </font><font face="Arial" color="#000100" size="2"><em>Markov Chain Monte Carlo in Practice</em></font><font face="Arial" color="#000100" size="2">. W.R. Gilks, S. Richardson and D.J. Spiegelhalter (eds.), New York: Chapman &amp; Hall, pp. 359--379.<br><br>Richardson, S. (1992). Statistical methods for geographical correlation studies. In </font><font face="Arial" color="#000100" size="2"><em>Geographical and Environmental Epidemiology</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J. Cuzick, D. English and R. Stern (eds.), Oxford: Oxford University Press, p. 181-204.<br><br>Shaddick, G. and Wakefield, J. (2002). Modelling daily multivariate pollutant data at multiple sites. </font><font face="Arial" color="#000100" size="2"><em>Applied Statistics</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>51</strong></font><font face="Arial" color="#000100" size="2">, 351-372.<br><br>Stern, H.S. and Cressie, N.A. (1999). Inference for extremes in disease mapping. In </font><font face="Arial" color="#000100" size="2"><em>Disease mapping and risk assessment for public health</em></font><font face="Arial" color="#000100" size="2">. A. Lawson, A. Biggeri, D. Bohning, E. Lesaffre, J-F. Viel and R. Bertollini (eds.), Chichester: Wiley, p. 63--84.<br><br>Wakefield, J.C., Best, N.G., and Waller, L.A. (2000). Bayesian Approaches to Disease Mapping. In </font><font face="Arial" color="#000100" size="2"><em>Spatial Epidemiology: Methods and Applications</em></font><font face="Arial" color="#000100" size="2">. P. Elliott, J.C. Wakefield, N.G. Best and D.J. Briggs (eds), Oxford: Oxford University Press, p. 104-127.<br><br>Wolpert, R.L. and Ickstadt, K. (1998). Poisson/Gamma random field models for spatial statistics. </font><font face="Arial" color="#000100" size="2"><em>Biometrika</em></font><font face="Arial" color="#000100" size="2">, </font><font face="Arial" color="#000100" size="2"><strong>85</strong></font><font face="Arial" color="#000100" size="2">, 251-267.</font></p></body></html>