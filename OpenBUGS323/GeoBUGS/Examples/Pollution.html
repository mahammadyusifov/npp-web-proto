<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Pollution</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="pollution0.bmp" alt="[pollution0]">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="6">Random walk priors for<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temporal smoothing of daily<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;air pollution estimates</font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>Shaddick and Wakefield (2002) consider spatiotemporal modelling of daily ambient air pollution at a number of monitoring sites in London. Here we take a subset of their data on a single pollutant measured at one site for 366 days, and model temporal autocorrelation using a random walk prior. <br><br>Conditional on the underlying mean concentration </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> on day t, the likelihood for the observed pollution concetration Y</font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">is assumed to be independent Normal i.e.<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;Y</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>err</sub></font><font face="Arial" color="#000100" size="3">) where 1/</font><font face="Symbol" color="#000100" size="3">t</font><font face="Arial" color="#000100" size="2"><sub>err</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the measurement error variance<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">&nbsp;&nbsp;&nbsp;m</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> = </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3"><br><br>where </font><font face="Symbol" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="3"> is the overall mean pollution concentration at the site, and </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="3"><sub>t </sub></font><font face="Arial" color="#000100" size="3">is a (zero mean) random error term representing daily fluctuations about this mean. To reflect the prior belief that these daily fluctuations are correlated, a <a href="../GeoBUGS/Manuals/Manual.html#rw"></font><font face="Arial" color="#0000FF" size="3"><u>random&nbsp;walk</u></font><font face="Arial" color="#000100" size="3"></a> prior is assumed for</font><font face="Symbol" color="#000100" size="3"> </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">= </font><font face="Symbol" color="#000100" size="3">{q</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, ......, </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>366</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">} (see equation 7 in Shaddick and Wakefield):<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> )&nbsp;&nbsp;&nbsp;for t = 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">)/2, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 2 )&nbsp;&nbsp;&nbsp;for t = 2, ...., T-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> )&nbsp;&nbsp;&nbsp;for t = T<br><br>where </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">denotes all elements of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Symbol" color="#000100" size="3"> </font><font face="Arial" color="#000100" size="3">except the </font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3">. This prior may be specified in WinBUGS 1.4 using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution, with adjacency vector </font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3"> listing neighbouring time points (i.e. (t-1) and (t+1) are neighbours of time point t), corresponding weight vector </font><font face="Arial" color="#000100" size="3"><strong><em>weight[]</em></strong></font><font face="Arial" color="#000100" size="3"> set to a sequence of 1's, and vector giving the number of neighbours, </font><font face="Arial" color="#000100" size="3"><strong><em>num[]</em></strong></font><font face="Arial" color="#000100" size="3">, set to 2 for all time points except </font><font face="Arial" color="#000100" size="3"><strong><em>num[1]</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>num[T] </em></strong></font><font face="Arial" color="#000100" size="3">which are set to 1. <br><br>The RW(1) reflects prior beliefs about smoothness of first differences, i.e. sudden jumps between consecutive values of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">are unlikely. Alternatively, we may assume a second order random walk prior RW(2) for </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">, which represents prior beliefs that the rate of change (gradient) of </font><font face="Symbol" color="#000100" size="3"><strong>q</strong></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is smooth:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"> | </font><font face="Symbol" color="#000100" size="3">q</font><font face="Symbol" color="#000100" size="2"><sub>-</sub></font><font face="Arial" color="#000100" size="2"><sub>t</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( </font><font face="Arial" color="#000100" size="3">(2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">) / 5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = 2 <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">4</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">- q</font><font face="Arial" color="#000100" size="2"><sub>t+2</sub></font><font face="Arial" color="#000100" size="3">) / 6, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 6 ) for t = 3, ...., T - 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( (-q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ 4q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t+1</sub></font><font face="Arial" color="#000100" size="3">) / 5, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> / 5 ) for t = T -1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;~ Normal </font><font face="Symbol" color="#000100" size="3">( -q</font><font face="Arial" color="#000100" size="2"><sub>t-2</sub></font><font face="Symbol" color="#000100" size="3">+ </font><font face="Arial" color="#000100" size="3">2</font><font face="Symbol" color="#000100" size="3">q</font><font face="Arial" color="#000100" size="2"><sub>t-1</sub></font><font face="Arial" color="#000100" size="3">, </font><font face="Symbol" color="#000100" size="3">f</font><font face="Arial" color="#000100" size="3"> ) for t = T<br><br>Again this may be specified using the </font><font face="Arial" color="#000100" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000100" size="3">distribution in OpenBUGS via appropriate specification of the </font><font face="Arial" color="#000100" size="3"><strong><em>adj[]</em></strong></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><strong><em>weight[]</em></strong></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><strong><em>num[]</em></strong></font><font face="Arial" color="#000100" size="3"> vectors.<br><br>The model code for fitting these two models is given below.<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Model</strong></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3"></font><font face="Arial" color="#000100" size="3">#likelihood</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(t in 1:T) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y[t] ~ dnorm(mu[t], tau.err)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu[t] &lt;- beta + theta[t]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1"></font><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior for temporal effects <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># RW prior for theta[t] - specified using car.normal with <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#neighbours (t-1) and (t+1) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># for theta[2],....,theta[T-1], and neighbours (t+1) for <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#theta[1] and (t-1) for theta[T]<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;theta[1:T] ~ car.normal(adj[], weights[], num[], tau) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;beta ~ dflat()<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Specify weight matrix and adjacency matrix corresponding to RW(1) prior</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># (Note - this could be given in the data file instead)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 1:1) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t] &lt;- t+1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 2:(T-1)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[2+(t-2)*2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[2+(t-2)*2] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[3+(t-2)*2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[3+(t-2)*2] &lt;- t+1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in T:T) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-2)*2 + 2] &lt;- 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-2)*2 + 2] &lt;- t-1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Alternatively, a weight matrix and adjacency matrix <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#corresponding to RW(2) prior can<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# be specified or given in the data file <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#(note, no need to change the prior distribution<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# on theta, just the weights/adjacencies)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in 1:1) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[t+1] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+1] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in 2:2) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+1] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+1] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+2] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+2] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;weights[t+3] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[t+3] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#for(t in 3:(T-2)) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[6+(t-3)*4] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[6+(t-3)*4] &lt;- t-2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[7+(t-3)*4] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[7+(t-3)*4] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[8+(t-3)*4] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[8+(t-3)*4] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[9+(t-3)*4] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[9+(t-3)*4] &lt;- t+2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 4<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in (T-1):(T-1)) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 6] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 6] &lt;- t+1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 7] &lt;- 4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 7] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 8] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 8] &lt;- t-2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 3<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;for(t in T:T) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 9] &lt;- 2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 9] &lt;- t-1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights[(T-4)*4 + 10] &lt;- -1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adj[(T-4)*4 + 10] &lt;- t-2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num[t] &lt;- 2<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># other priors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau.err ~ dgamma(0.01, 0.01)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# measurement error precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma.err &lt;- 1 / sqrt(tau.err)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma2.err &lt;- 1/tau.err<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.01, 0.01)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# random walk precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma &lt;- 1 / sqrt(tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;sigma2 &lt;- 1/tau<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# include this variable to use in time series (model fit) plot<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;for(t in 1:T) { day[t] &lt;- t }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Note that pollution concentrations were not measured every day. However it is necessary to include days with no measurements as missing values (NA) in the data set, otherwise the temporal neighbourhood structure cannot be specified correctly.<br></font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Pollutiondata.html">Data</a></u></strong></font><font face="Arial" color="#000000" size="2"> &nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(Click to open) </font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Pollutioninits.html">Inits&nbsp;for&nbsp;chain&nbsp;1</a>&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Pollutioninits1.html">Inits&nbsp;for&nbsp;chain&nbsp;2</a></u></strong></font><font face="Arial" color="#000000" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">(Click to open) </font><font face="Arial" color="#000000" size="2"><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#000100" size="3"><br>Plus click on </font><font face="Arial" color="#000100" size="3"><em>gen inits</em></font><font face="Arial" color="#000100" size="3"> to generate initial values for the missing data<br></font><font face="Arial" color="#000100" size="2"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Results</strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br>RW(1) prior:<br><center><br><img src="pollution1.bmp" alt="[pollution1]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"></center></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Plot of posterior median (red line) and posterior 95% intervals (dashed blue lines) for mu[t] (the true mean daily pollutant concentration), with observed concentrations shown as black dots. (This plot was produced by selecting the </font><font face="Arial" color="#000100" size="3"><em>model fit</em></font><font face="Arial" color="#000100" size="3"> option from the </font><font face="Arial" color="#000100" size="3"><em>Compare</em></font><font face="Arial" color="#000100" size="3"> menu (available from the </font><font face="Arial" color="#000100" size="3"><em>Inference</em></font><font face="Arial" color="#000100" size="3"> menu), with </font><font face="Arial" color="#000100" size="3"><em>mu</em></font><font face="Arial" color="#000100" size="3"> specified as the </font><font face="Arial" color="#000100" size="3"><em>node</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><em>day</em></font><font face="Arial" color="#000100" size="3"> as the </font><font face="Arial" color="#000100" size="3"><em>axis</em></font><font face="Arial" color="#000100" size="3"> and </font><font face="Arial" color="#000100" size="3"><em>y</em></font><font face="Arial" color="#000100" size="3"> as </font><font face="Arial" color="#000100" size="3"><em>other</em></font><font face="Arial" color="#000100" size="3">). Note that the dashed blue line shows the posterior 95% interval for the estimated mean daily concentration, and is not a predictive interval - hence we would not necessarily expect all of the observed data points to lie within the interval.<br></font><font face="Arial" color="#000100" size="2">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#FF8040" size="6"><strong><img src="pollution2.bmp" alt="[pollution2]"></strong></font><font face="Arial" color="#000100" size="3"><br><br>Equivalent plot assuming an RW(2) prior. Note the greater amount of smoothing imposed by this prior:<br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="2"><u></u></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><img src="pollution3.bmp" alt="[pollution3]"></font></p></body></html>