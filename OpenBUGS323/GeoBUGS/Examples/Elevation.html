<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Elevation</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="elevation0.bmp" alt="[elevation0]">&nbsp;&nbsp;&nbsp;</font><font face="Courier New" color="#000100" size="6">Bayesian kriging and spatial<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prediction:Surface elevation</font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#000000" size="3"><br>The data for this example are taken from Diggle and Riberio (2000) (and came originally from Davis (1973)). The data file contains the variables height, x and y, giving surface elevation at each of 52 locations (x, y) within a 310-foot square. The unit of distance is 50 feet, whereas one unit of height represents 10 feet of elevation. A Gaussian kriging model can be fitted to these data in OpenBUGS using either the </font><font face="Arial" color="#000100" size="3"><strong><em><a href="../GeoBUGS/Manuals/Manual.html#spatial.exp"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.exp</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em><a href="../GeoBUGS/Manuals/Manual.html#spatial.exp"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.disc</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> distributions. The data file also contains a set of locations x.pred and y.pred representing a 15 x 15 grid of points at which we wish to predict surface elevation. Predictions can be obtained using either the </font><font face="Arial" color="#000100" size="3"><strong><em><a href="../GeoBUGS/Manuals/Manual.html#spatial.exp.pred"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.pred</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> or </font><font face="Arial" color="#000100" size="3"><strong><em><a href="../GeoBUGS/Manuals/Manual.html#spatial.exp.pred"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>spatial.unipred</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000000" size="3"> predictive distributions in OpenBUGS<br></font><font face="Arial" color="#000100" size="3"><strong><br></strong></font><font face="Arial" color="#0000FF" size="3"><strong>Model</strong></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Spatially structured multivariate normal likelihood </font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#FF0000" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># exponential correlation function<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height[1:N] ~ spatial.exp(mu[], x[], y[], tau, phi, kappa)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# disc correlation function <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;height[1:N] ~ spatial.disc(mu[], x[], y[], tau, alpha)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(i in 1:N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;mu[i] &lt;- beta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Priors</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">beta ~ dflat()<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.001, 0.001) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma2 &lt;- 1/tau<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># priors for spatial.exp parameters<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior range for correlation at min distance (0.2 x 50 ft) is 0.02 to 0.99<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;phi ~ dunif(0.05, 20)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior range for correlation at max distance (8.3 x 50 ft) is 0 to 0.66<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;kappa ~ dunif(0.05,1.95)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># priors for spatial.disc parameter<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior range for correlation at min distance (0.2 x 50 ft) is 0.07 to 0.96<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">#&nbsp;&nbsp;&nbsp;alpha ~ dunif(0.25, 48)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior range for correlation at max distance (8.3 x 50 ft) is 0 to 0.63<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Spatial prediction</font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Single site prediction<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:M) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height.pred[j] ~ spatial.unipred(beta, x.pred[j], y.pred[j], height[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Only use joint prediction for small subset of points, due to length of time it takes to run<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(j in 1:10) { mu.pred[j] &lt;- beta }<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;height.pred.multi[1:10] ~ spatial.pred(mu.pred[], x.pred[1:10], y.pred[1:10], height[]) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Elevationdata.html">Data</a></u></strong></font><font face="Arial" color="#0000FF" size="3"><u>&nbsp;&nbsp;&nbsp;</u></font><font face="Arial" color="#000100" size="3">(Click to open)<br><br>Initial values for exponential model<br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Elevationinits.html">Inits&nbsp;for&nbsp;chain&nbsp;1</a>&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Elevationinits1.html">Inits&nbsp;for&nbsp;chain&nbsp;2</a>&nbsp;&nbsp;&nbsp;</u></strong></font><font face="Arial" color="#000100" size="3">(Click to open)</font><font face="Arial" color="#0000FF" size="3"><u><br><br><br></u></font><font face="Arial" color="#000100" size="3">Initial values for disc model</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/ElevationDiscinits.html">Inits&nbsp;for&nbsp;chain&nbsp;1</a>&nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/ElevationDiscinits1.html">Inits&nbsp;for&nbsp;chain&nbsp;2</a>&nbsp;&nbsp;&nbsp;</u></strong></font><font face="Arial" color="#000100" size="3">(Click to open)</font><font face="Arial" color="#0000FF" size="3"><u><br><br></u></font><font face="Arial" color="#000100" size="3">Results for exponential model</font><font face="Arial" color="#0000FF" size="3"><br><center></font><font face="Arial" color="#000100" size="3"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="elevation1.bmp" alt="[elevation1]"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="elevation2.bmp" alt="[elevation2]"><br><br></center></font><font face="Arial" color="#0000FF" size="3"><u><br></u></font><font face="Arial" color="#000100" size="3">Results for disc model<br></font><font face="Arial" color="#0000FF" size="3"><br><center><img src="elevation3.bmp" alt="[elevation3]"><br><br><br><img src="elevation4.bmp" alt="[elevation4]"><br></center></font><font face="Arial" color="#000100" size="3"><br>The GeoBUGS map tool can be used to produce an approximate map of the posterior mean predicted surface elevation. It is not possible to map point locations using GeoBUGS. However, a map file called </font><font face="Arial" color="#000100" size="3"><strong><em>elevation</em></strong></font><font face="Arial" color="#000100" size="3"> is already loaded in the GeoBUGS Map Tool --- this is a 15 x 15 grid with the centroids of the grid cell corresponding to the locations of each of the prediction points. You can use this to produce a map of the posterior mean (or other posterior summaries) of the vector of predicted values </font><font face="Arial" color="#000100" size="3"><strong><em>height.pred</em></strong></font><font face="Arial" color="#000100" size="3">. <br><br></font></p></body></html>