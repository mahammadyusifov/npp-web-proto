<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Scotland</title></head><body><p><font face="Arial" color="#000100" size="3"><strong><img src="scotland0.bmp" alt="[scotland0]">&nbsp;&nbsp;&nbsp;</strong></font><font face="Courier New" color="#000100" size="6">Conditional Autoregressive<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(CAR) models for disease<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mapping: Lip cancer in<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scotland</font><font face="Arial" color="#000100" size="3"><strong><br><br></strong></font><font face="Arial" color="#000100" size="3">The rates of lip cancer in 56 counties in Scotland have been analysed by Clayton and Kaldor (1987) and Breslow and Clayton (1993). The form of the data includes the observed and expected cases (expected numbers based on the population and its age and sex distribution in the county), a covariate measuring the percentage of the population engaged in agriculture, fishing, or forestry, and the &quot;position'' of each county expressed as a list of adjacent counties.<br><br><img src="scotland1.bmp" alt="[scotland1]">We note that the extreme SMRs (Standardised Mortality Ratios) are based on very few cases.<br><br>We may smooth the raw SMRs by fitting a random-effects Poisson model allowing for spatial correlation, using the intrinsic conditional autoregressive (CAR) prior proposed by Besag, York and Mollie (1991). For the lip cancer example, the model may be written as:<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">O</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(</font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">log </font><font face="Symbol" color="#000100" size="3">m</font><font face="Arial" color="#000100" size="2"><sub>i </sub></font><font face="Arial" color="#000100" size="3">=&nbsp;&nbsp;&nbsp;og E</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> + </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3">x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> / 10 + </font><font face="Symbol" color="#000100" size="3"></font><font face="Arial" color="#000100" size="3">b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub><br></sub></font><font face="Arial" color="#000100" size="3"><br>where </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> is an intercept term representing the baseline (log) relative risk of disease across the study region, x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"><sub> </sub></font><font face="Arial" color="#000100" size="3">is the covariate &quot;percentage of the population engaged in agriculture, fishing, or forestry&quot; in district i, with associated regression coefficient </font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="2"><sub>1</sub></font><font face="Arial" color="#000100" size="3"> and b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> is an area-specific random effect capturing the residual or unexplained (log) relative risk of disease in area i. We often think of b</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> as representing the effect of latent (unobserved) risk factors. <br><br>To allow for spatial dependence between the random effects b</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> in nearby areas, we may assume a CAR prior for these terms. Technical details, including parameterisation and a discussion of suitable hyperpriors for the parameters of this model, are given in </font><font face="Arial" color="#0000FF" size="3"><a href="../GeoBUGS/Manuals/Manual.html#Appendix"></font><font face="Arial" color="#0000FF" size="3"><u>appendix&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#000100" size="3">. The </font><font face="Arial" color="#000100" size="3"><strong><em><a href="../GeoBUGS/Manuals/Manual.html#car.normal"></em></strong></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>car.normal</u></em></strong></font><font face="Arial" color="#000100" size="3"><strong><em></a></em></strong></font><font face="Arial" color="#000100" size="3"> distribution may be used to fit this model. The code for the lip cancer data is given below:<br><br></font><font face="Arial" color="#0000FF" size="3"><strong>Model</strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#FF0000" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for (i in 1 : N) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">O[i] ~ dpois(mu[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">log(mu[i]) &lt;- log(E[i]) + alpha0 + alpha1 * X[i]/10 + b[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Area-specific relative risk (for maps)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">RR[i] &lt;- exp(alpha0 + alpha1 * X[i]/10 + b[i]) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># CAR prior distribution for random effects: <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">b[1:N] ~ car.normal(adj[], weights[], num[], tau)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(k in 1:sumNumNeigh) {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">&nbsp;&nbsp;&nbsp;weights[k] &lt;- 1<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Other priors:<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha0 ~ dflat() <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">alpha1 ~ dnorm(0.0, 1.0E-5)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau ~ dgamma(0.5, 0.0005) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# prior on precision<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma &lt;- sqrt(1 / tau)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# standard deviation<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.mean &lt;- sum(b[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Scotlanddata.html">Data</a>&nbsp;&nbsp;&nbsp;</u></strong></font><font face="Arial" color="#000000" size="3">(click to open)</font><font face="Arial" color="#0000FF" size="3"><br></font><font face="Arial" color="#000000" size="3"><br>Note that the data for the adjacency matrix (variables </font><font face="Arial" color="#000000" size="3"><strong><em>adj</em></strong></font><font face="Arial" color="#000000" size="3">, </font><font face="Arial" color="#000000" size="3"><strong><em>num</em></strong></font><font face="Arial" color="#000000" size="3"> and </font><font face="Arial" color="#000000" size="3"><strong><em>SumNumNeigh</em></strong></font><font face="Arial" color="#000000" size="3">) have been generated using the <a href="../GeoBUGS/Manuals/Manual.html#Adj"></font><font face="Arial" color="#0000FF" size="3"><strong><em><u>adj&nbsp;matrix</u></em></strong></font><font face="Arial" color="#000000" size="3"></a> option of the </font><font face="Arial" color="#000000" size="3"><strong><em>Adjacency Tool</em></strong></font><font face="Arial" color="#000000" size="3"> menu in </font><font face="Arial" color="#000000" size="3"><em>GeoBUGS</em></font><font face="Arial" color="#000000" size="3">. By default, this treats islands as having no neighbours, and so the three areas representing the Orkneys, Shetland and the Outer Hebrides islands in Scotland have zero neighbours. You can <a href="../GeoBUGS/Manuals/Manual.html#Edit"></font><font face="Arial" color="#0000FF" size="3"><u>edit</u></font><font face="Arial" color="#000000" size="3"></a> the adjacency map of Scotland to include these areas as neighbours if you wish. The </font><font face="Arial" color="#000000" size="3"><strong><em>car.normal</em></strong></font><font face="Arial" color="#000000" size="3"> distribution sets the value of b</font><font face="Arial" color="#000000" size="3"><sub>i</sub></font><font face="Arial" color="#000000" size="3"> equal to zero for areas i that are islands. Hence the posterior relative risks for the Orkneys, Shetland and the Outer Hebrides in the present example will just depend on the overall baseline rate </font><font face="Arial" color="#000100" size="3"></font><font face="Symbol" color="#000100" size="3">a</font><font face="Arial" color="#000100" size="3"><sub>0</sub></font><font face="Arial" color="#000100" size="3"> and the covariate x</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. Alternatively, you could specify a </font><font face="Arial" color="#000100" size="3"><em>convolution</em></font><font face="Arial" color="#000100" size="3"> prior for the area-specific random effects (Besag, York and Mollie 1991) which partitions the overall random effect for each area into the sum of a spatial component plus a non-spatial component. In this model, the islands will just have a non-spatial term for the random effect. See </font><font face="Arial" color="#000000" size="3"><a href="../GeoBUGS/Examples/LHA.html"></font><font face="Arial" color="#0000FF" size="3"><u>example&nbsp;on&nbsp;lung&nbsp;cancer&nbsp;in&nbsp;a&nbsp;London Health&nbsp;Authority</u></font><font face="Arial" color="#000100" size="3"></a> for details of this model.</font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#0000FF" size="3"><strong><u><a href="../GeoBUGS/Examples/Scotlandinits.html">Inits&nbsp;for&nbsp;chain&nbsp;1</a> &nbsp;&nbsp;&nbsp;<a href="../GeoBUGS/Examples/Scotlandinits1.html">Inits&nbsp;for&nbsp;chain&nbsp;2</a>&nbsp;&nbsp;&nbsp;</u></strong></font><font face="Arial" color="#000000" size="3">(click to open)</font><font face="Arial" color="#000100" size="3"><br><br>Note that the initial values for elements 6, 8 and 11 of the vector </font><font face="Arial" color="#000100" size="3"><strong>b</strong></font><font face="Arial" color="#000100" size="3"> are set to NA since these correspond to the three islands (</font><font face="Arial" color="#000000" size="3">Orkneys, Shetland and the Outer Hebrides). The values of </font><font face="Arial" color="#000000" size="3"><strong>b</strong></font><font face="Arial" color="#000000" size="3"> are set to zero by the </font><font face="Arial" color="#000000" size="3"><strong><em>car.normal </em></strong></font><font face="Arial" color="#000000" size="3">prior for these 3 areas, and so they are not stochastic nodes.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<center><img src="scotland2.bmp" alt="[scotland2]"><br><br><br><img src="scotland3.bmp" alt="[scotland3]"></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3"><br><br></font></center></p></body></html>