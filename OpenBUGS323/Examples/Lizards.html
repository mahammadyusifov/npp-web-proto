<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Lizards</title></head><body><p><font face="Arial" color="#000100" size="2"><img src="lizards0.bmp" alt="[lizards0]"></font><font face="Courier New" color="#000100" size="6"> Lizards: Binomial mixture model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for modelling and estimation of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abundance in the presence of<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imperfect detection</font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(contributed by Marc Kery)<br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Abundance, or population size, is the central quantity in much of ecology (e.g., Krebs, </font><font face="Arial" color="#000100" size="3"><em>Addison Wesley</em></font><font face="Arial" color="#000100" size="3">, 2001). Abundance is assessed by counting individuals, and patterns in abundance are typically modelled by assuming some sort of a Poisson GLM for these counts. This approach neglects the important fact that almost universally some individuals are overlooked; i.e., individual detection probability is arguably always less than 1 in the field. This means that counts usually underestimate true abundance. Worse yet, covariates that affect detectability may mask true covariate relationships with abundance, distort them or feign spurious abundance relationships.<br><br>Historically, two approaches to correct for imperfect detection and thus to estimate true abundance are distance sampling (Buckland </font><font face="Arial" color="#000100" size="3"><em>et al.</em></font><font face="Arial" color="#000100" size="3">, 2001, 2004) and capture-recapture (Williams et al., </font><font face="Arial" color="#000100" size="3"><em>Academic Press</em></font><font face="Arial" color="#000100" size="3">, 2002). A third, &quot;cheaper&quot; method (in terms of field protocol) is the binomial mixture or N - mixture model (Royle, </font><font face="Arial" color="#000100" size="3"><em>Biometrics</em></font><font face="Arial" color="#000100" size="3">, 2004). Based on counts that are replicated both over multiple sites and multiple surveys within a time period of geographic and demographic closure, abundance and detection probability can be estimated separately along with their relationships with measured covariates. Here, we present a hierarchical, or state-space, implementation of the model that explicitly contains parameters for the latent state N</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, that is, abundance at site i.<br><br>This model is structurally similar to the site-occupancy model (see Gentians example), the main difference being that as a model for the latent state the Poisson is chosen rather than the Bernoulli. Like the site-occupancy model (see there), the binomial mixture model can be fitted in WinBUGS in a &quot;square data format&quot;, where rows denote sites and columns repeated surveys. However, for imbalanced data, a &quot;vertical data format&quot; is more convenient and for illustration, we show this here (the site-occupancy model can also be fitted in this format).<br><br>We describe count y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> at site</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> by two linked equations:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N</font><font face="Arial" color="#000100" size="3"><sub>site</sub></font><font face="Arial" color="#000100" size="3"><sub>i </sub></font><font face="Arial" color="#000100" size="3">~ Poisson(lambda</font><font face="Arial" color="#000100" size="3"><sub>site</sub></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, N</font><font face="Arial" color="#000100" size="3"><sub>site</sub></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)&nbsp;&nbsp;&nbsp;<br><br>Again, like in the case of the site-occupancy model, the first line describes the true biological process: true abundance, the latent state N</font><font face="Arial" color="#000100" size="3"><sub>site</sub></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, i.e., local population size N at population</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. The simplest distributional assumption is that of a Poisson distribution, but other distributions like the negative binomial are also possible or one could model a normal random effect into log(lambda). Given the particular realisation of the Poisson random process, i.e., a particular N</font><font face="Arial" color="#000100" size="3"><sub>site</sub></font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, the observed data, count y</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, follows a binomial distribution indexed by local population size and &quot;success probability&quot; = detection probability p</font><font face="Arial" color="#000100" size="3"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. Covariate effects can be modelled into the Poisson and the Binomial mean in a simple GLM fashion.<br><br>This binomial mixture model example, though inspired by nature (K&eacute;ry </font><font face="Arial" color="#000100" size="3"><em>et al.</em></font><font face="Arial" color="#000100" size="3">, in press) is based on simulated data of replicated counts of sand lizards (Lacerta agilis) in The Netherlands. Lizards were counted at 200 survey sites three times during a time period when the population was assumed closed. True abundance was assumed to be positively related to vegetation density (scaled -1 to 1) but detection probability was assumed to be lower in higher than in lower vegetation, and in addition, positively affected by temperature (scaled -1 to 1).<br><br></font><font face="Arial" color="#000100" size="3"><strong>Hints:</strong></font><font face="Arial" color="#000100" size="3"> Good starting values can be essential for fitting the model successfully. One plus the max observed at each site is a good choice. Scaling of covariates is also important.<br></font><font face="Arial" color="#000000" size="3"><br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">model <br>&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Binomial mixture model for 'vertical' data format<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Priors<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">alpha.lam ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">beta.lam ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">alpha.p ~ dunif(-10, 10) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">beta1.p ~ dunif(-10, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">beta2.p ~ dunif(-10, 10)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Likelihood<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Biological model for true abundance<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:R) {# Loop over R sites<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">N[i] ~ dpois(lambda[i])C(,50)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">log(lambda[i]) &lt;- alpha.lam + beta.lam * vege.lam[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Observation model for replicated counts<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for (i in 1:n) {# Loop over all n observations<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">C[i] ~ dbin(p[i], N[site[i]])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">lin.pred[i] &lt;- alpha.p + beta1.p * vege.p[i] + beta2.p * temperature[i]<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">p[i] &lt;- exp(lin.pred[i]) / (1 + exp(lin.pred[i]))<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># Derived quantities<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">&nbsp;&nbsp;&nbsp;totalN &lt;- sum(N[ ]) # Estimate total population size across all sites<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br><br><br></font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Lizardsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Lizardsinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"> </a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Lizardsinits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2 </u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Lizardsinits3.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;3</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br><br></font><font face="Arial" color="#000100" size="2"><br><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#0000FF" size="3"><strong> <br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Running 3 chains for 11k iterations, with 1k discarded as a burnin, yields these results <br><center><br><img src="lizards1.bmp" alt="[lizards1]"><br></center><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="3">Note that although convergence is somewhat iffy, these stimates compare very well with the data-generating parameters (alpha's and beta's, same order as above): 2, -1, 1, -3 and 2. Also, they are almost identical to the MLE's obtained by maximising the likelihood numerically in R (see K&eacute;ry </font><font face="Arial" color="#000100" size="3"><em>et al.</em></font><font face="Arial" color="#000100" size="3">, </font><font face="Arial" color="#000100" size="3"><em>Ecol. Appl.</em></font><font face="Arial" color="#000100" size="3">, 2005): 2.142415, -1.258583, 1.113543, -3.169582, and 2.014300.<br>&nbsp;&nbsp;&nbsp;In addition, the estimate of totalN should be compared to known total population size across all 200 sites of 1700, with a sum of site maxima of only 692 observed lizards. In contrast, a na&iuml;ve Poisson regression on observed max counts for each site is totally unable to pick up the positive effect of vegetation on abundance and vastly underestimates abundance.<br></font></p></body></html>