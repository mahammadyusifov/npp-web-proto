<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Birds</title></head><body><p><font face="Arial" color="#000100" size="3"></font><font face="Arial" color="#0000FF" size="5"><strong><img src="birds0.bmp" alt="[birds0]"></strong></font><font face="Courier New" color="#000100" size="6"> Birds: species richness,estimating<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the size of a Closed &quot;Population&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with individual heterogeneity in<br>detection probability </font><font face="Arial" color="#000100" size="3"><br></font><font face="Courier New" color="#000100" size="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(contributed by Marc Kery)<br></font><font face="Arial" color="#000100" size="3"><br>This example expands on the previous example of estimating the size of a closed population by allowing for each individual to have its own detection probability. Let J denote the number of sample occasions. The observations are the number of encounters (out of J samples) on each of n individuals, y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for i =1, 2,...,nind. We suppose that, for each individual in the population, <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) ~ Normal(mu, tau) &nbsp;&nbsp;&nbsp;for i = 1, 2, ...., N <br><br>where N is the total number of individuals in the population. This model is sometimes referred to as a &quot;Model Mh&quot; in the jargon of capture-recapture. A large number of mixture models have been suggested for this situation (see Pledger 2000; Coull and Agresti 1999; Dorazio and Royle 2003). See Link (2003) for additional context. One area of widespread use for such models is in estimating the size of a biological community. In this context, we equate species to &quot;individual&quot; and &quot;population size&quot; is then the size of the community (a quantity often referred to as &quot;species richness&quot;). For this problem, allowing for species-specific detection probabilities is a necessary component of the model due to differences in behavior, biology, and difficulty with which individuals may be detected by observers. Here we adopt an analysis of the model by data augmentation. The formulation and analysis here follows that of Royle and Dorazio (2008; Chapter 6). The specific data set consists of detection frequencies for nind = 71 bird species along a Breeding Bird Survey route in Maryland (Dorazio and Royle 2003). There were J=50 replicate samples of the community. If N were known the model would simply be a binomial mixture: <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, J)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) ~Normal(mu, tau) for i = 1, 2, ...., N <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>However, N is unknown, so that the number of y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 0 &quot;observations&quot;, that is, the number of species that are present in the community but were not detected, is also unknown. As in the closed population size estimation example, we deal with unknown-N by data augmentation. Data augmentation -- For analysis by data augmentation, we introduce excess zero &quot;observations&quot; y</font><font face="Arial" color="#000100" size="2"><sub>n +1</sub></font><font face="Arial" color="#000100" size="3">= 0,...,y</font><font face="Arial" color="#000100" size="2"><sub>M</sub></font><font face="Arial" color="#000100" size="3"> = 0, and a set of latent indicator variables z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">; i = 1,2,...,M with <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(psi). <br><br>If z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 1, then element i of the list corresponds to a member of the population of size N, and if <br>z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 0, it is an excess 0 relative to the binomial model. M is set arbitrarily large. It can be motivated as the upper limit of a discrete uniform prior for N. That is, <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N ~ dunif(0 ,M). <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>The model for the augmented data is: <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(psi) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">* p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, J) # zero-inflation accomplished by z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> * p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logit(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) ~ Normal(mu, tau) for i = 1, 2, ...., M # note upper bound here is M not N <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>Prior distributions are: <br><br>&nbsp;&nbsp;&nbsp;psi ~ unif(0, 1) <br>&nbsp;&nbsp;&nbsp;mu ~ dnorm(0, 0.001) <br>&nbsp;&nbsp;&nbsp;tau ~ dgamma(0.001, 0.001) <br>&nbsp;&nbsp;&nbsp;<br>Comments: <br>(1) The population size parameter is a derived parameter: N = </font><font face="Symbol" color="#000100" size="5">S</font><font face="Arial" color="#000100" size="3"> z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. <br>(2) This model is precisely a zero-inflated binomial mixture model. Likelihood analysis of this model is also straightforward (Coull and Agresti 1999; Royle 2006). <br>(3) We have assumed here that individual detection probabilities do not vary over time, but the example here can be easily modified to allow such generality, by formulating the binomial observation model in terms of its individual Bernoulli components. In the subsequent analysis, we have augmented the data set with 250 y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = 0 individuals. <br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model { <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># prior distributions <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">psi~dunif(0,1) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu~dnorm(0,0.001) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">tau~dgamma(.001,.001) # zero-inflated binomial mixture model for <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the augmented data <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(i in 1: nind + nz){ <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">z[i] ~ dbern(psi) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">eta[i]~ dnorm(mu, tau) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logit(p[i])&lt;- eta[i] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">muy[i]&lt;-p[i] * z[i] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dbin(muy[i], J) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Derived parameters <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">N&lt;-sum(z[1 : nind + nz]) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">sigma&lt;-sqrt(1 / tau) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">} <br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Birdsdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Birdsinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"> </a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Birdsinits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2 </u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u><br></u></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="3"> <br>Two chains were run for 11000 iterations which produced the following estimates: <br><center><br><img src="birds1.bmp" alt="[birds1]"><br></center><br>The posterior distribution of N is shown below. We see that M was probably excessive and we could save some computational effort by reducing the number of zero observations added to the data set. <br><br><img src="birds2.bmp" alt="[birds2]"></font></p></body></html>