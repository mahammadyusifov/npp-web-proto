<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Impala</title></head><body><p><font face="Arial" color="#000100" size="1"><br><img src="impala0.bmp" alt="[impala0]"></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Courier New" color="#000100" size="6">Impala: distance Sampling </font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(contributed by Andy Royle)<br></font><font face="Arial" color="#000100" size="3"><br>Distance sampling is a popular method for estimating the density of populations based on observed distances between objects and line or point (see Buckland et al. 2001). It can be viewed as a special type of closed population model for estimating population size, having J=1 replicate sample and with distance from line or point to individual as an &quot;individual covariate&quot;. We adopt that view here, and thus analyze the model using data augmentation (as in the closed population examples given previously). This analysis derives from Royle and Dorazio (2008; Chapter 7). <br><br>The data set is the famous &quot;Impala data&quot; from Burnham (1980), consisting of distance measurements on 73 individuals along linear transects truncated to a width of 400 m. Distances were scaled here to be in units of 100 m.<br><br>Let N be the population size of individuals susceptible to sampling. If N is known, the observation model is:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>where<br><br>p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = g(x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">; theta)<br><br>x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = distance to individual i and g() is the detection probability function. Here we consider the half-normal detection function:<br><br>g(x) = exp-(x / theta)</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3"><br><br><br>Data augmentation -- We do not know N in practice. In fact, we only observe the y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">=1 observations. We handle that in the analysis using data augmentation (see Royle and Dorazio (2008, Ch. 7)). We add the &quot;observations&quot; y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">= 0 for i = nind +1, nind + 2,...., M for M sufficiently large. We introduce the latent indicator variables z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for i=1,2,...., M with<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli( psi ) for i = 1, 2, ...., M # note: specified for all M individuals<br><br>(this implies N ~ dunif(0, M) so choose M accordingly). For analysis of the impala data, data augmentation is based on nz=300 y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">=0 observations.<br><br>Distance, x, is only observed for individuals that are detected, and it is regarded as missing data for the augmented individuals. We assume:<br><br>x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ uniform(0, B) for i = 1, 2, ...., M # note: specified for all M individuals<br><br>Where B is chosen to represent the upper-limit of observation (in practice, observations are truncated at some large distance). For the Impala data, B=4 (i.e., 400 meters). The &quot;missing&quot; values of x have to be passed to WinBUGS as missing values, indicated by NA (see below).<br><br>Model summary:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> | x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">, z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> * z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">) # observation model<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> = g(x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">; theta)<br>g(x) = exp((x / theta</font><font face="Arial" color="#000100" size="2"><sup>2</sup></font><font face="Arial" color="#000100" size="3">))<br>z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(psi) for i = 1, 2, ...., M # data augmentation<br>x</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ unif(0, B) for i = 1, 2, ...., M # distances<br><br>Prior distributions are specified as:<br>psi ~ uniform(0,1)<br>theta ~ uniform(0, U) # U chosen arbitrarily large<br><br>Under data augmentation, population size, N, and density, D are derived parameters: N = </font><font face="Symbol" color="#000100" size="6">S</font><font face="Arial" color="#000100" size="3"> z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> and, D = N / a, where a = area of the sample unit(s).<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model <br>&nbsp;&nbsp;&nbsp;{<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3"># Prior distributions<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">theta ~ dunif(0, 10)<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">theta2 &lt;- theta *theta<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">psi ~ dunif(0,1)<br><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">for(i in 1 : nind+nz){<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">z[i] ~ dbern(psi) # latent indicator variables from data augmentation<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">x[i] ~ dunif(0, 4) # distance is a random variable<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">logp[i]&lt;- -((x[i] * x[i]) / theta2) <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">p[i] &lt;- exp(logp[i])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">mu[i] &lt;- z[i] * p[i] <br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">y[i] ~ dbern(mu[i]) # observation model<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">N&lt;-sum(z[1:nind + nz])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">D&lt;- N / 48 # 48 km*km = total area of transects<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br></font><font face="Arial" color="#000100" size="5"><br><br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Impaladata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Impalainits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"> </a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Impalainits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2 </u></font><font face="Arial" color="#0000FF" size="3"></a><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">Note that initial values for the missing values of x are not provided. WinBUGS seems to do a good job picking those, but not always (sometimes there is a crash, so try again).</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#0000FF" size="5">Results</font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#000100" size="3">Results from 2 chains of length 10000 after 1000 burn-in. Estimated density is 3.75 individuals per square kilometer<br><center><br></font><font face="Arial" color="#000100" size="1"><br><img src="impala1.bmp" alt="[impala1]"><br></font></center></p></body></html>