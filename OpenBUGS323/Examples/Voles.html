<!DOCTYPE html PUBLIC "-//W3C//DTD Html 1.0 Strict//EN" "http://www.w3.org/TR/Html1/DTD/strict.dtd"><html><head><title>Voles</title></head><body><p><font face="Arial" color="#000100" size="1"><br><img src="voles0.bmp" alt="[voles0]"></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Courier New" color="#000100" size="6">Voles: estimating the size of a &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closed population using the data<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;augmentation technique</font><font face="Arial" color="#0000FF" size="3"><strong><br></strong></font><font face="Arial" color="#000100" size="2"><br></font><font face="Courier New" color="#000100" size="6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(contributed by Andy Royle)<br></font><font face="Arial" color="#000100" size="3"><br>Estimating the size of a closed population is a classical problem in statistical ecology. We consider the simplest of a huge class of models, referred to colloquially as &quot;Model M0&quot; in the jargon of capture-recapture. We provide a Bayesian analysis of this model based on data augmentation. Data augmentation can be used to analyze any capture-recapture model in which the population size, N, is unknown.<br><br>The standard design subjects a demograph population of size N to repeated sampling. Let J denote the number of sample occasions. The observations are the number of encounters (out of J samples) on each of n individually recognizable or marked individuals, y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> for i =1, 2,..., nind. The problem is to estimate the size of the population N = nind + n0, where n0 is the number of individuals not captured. <br><br>If we knew N, then the model for the observed data y</font><font face="Arial" color="#000100" size="1"><sub>i </sub></font><font face="Arial" color="#000100" size="3">would simply be that:<br><br>y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial(p, J) for i= 1, 2,...., N<br><br>In practice N is not known, and there are a number of ways for handling that in the model formulation, i.e., so that estimates of population size, N, can be obtained.<br><br></font><font face="Courier New" color="#000100" size="6">Classical solution</font><font face="Arial" color="#000100" size="3"><br><br>Since there are J +1 mutually exclusive outcomes (y = 0, 1, 2,..., J), the classical solution to the problem is to formulate the model for the encounter frequencies as a multinomial with unknown sample size N = nind + n0. The cell probabilities are binomial cell probabilities of the form p</font><font face="Arial" color="#000100" size="2"><sup>j</sup></font><font face="Arial" color="#000100" size="3">(1 - p)</font><font face="Arial" color="#000100" size="2"><sup>J - j</sup></font><font face="Arial" color="#000100" size="3">. <br><br>We do not know if the multinomial model can be implemented directly in WinBUGS. Here we provide an analysis of this simplest of models for estimation of population size by a technique called data augmentation (see Royle, Dorazio and Link, 2007, J. Comp. and Graph. Stats.).<br><br></font><font face="Courier New" color="#000100" size="6">Bayesian analysis based on data augmentation</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br>The two parameters are p and N (or n0) for which a natural prior specification is:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p ~ uniform(0,1) and <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N ~ uniform(0, M) for some large M.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>For implementation in WinBUGS it is convenient to use the following reparameterization of the uniform(0,M) prior: N|M ~ Binomial(psi, M) and psi ~ uniform(0,1). This is a hierarchical representation of the uniform(0, M) prior in the sense that when we marginalize [N|M,psi] over [psi], we are left with a uniform(0, M) prior for N. <br><br>This prior implies the existence of a collection of latent indicator variables z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernouli(psi) for i = 1, 2, ...., M such that N = </font><font face="Symbol" color="#000100" size="5">S</font><font face="Arial" color="#000100" size="3">z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">. To implement this model in WinBUGS we introduce excess zero &quot;observations&quot; y</font><font face="Arial" color="#000100" size="2"><sub>nind +1</sub></font><font face="Arial" color="#000100" size="3"> = 0,....., y</font><font face="Arial" color="#000100" size="2"><sub>M</sub></font><font face="Arial" color="#000100" size="3"> = 0, the set of latent indicator variables z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernouli(psi) and the model for the augmented data is:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Bernoulli(psi)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i = 1, 2,..... M [note M here not N]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> ~ Binomial( z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3"> * p, J)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for i = 1, 2, .... M [note M here not N]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psi ~ uniform(0, 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p ~ uniform(0, 1)<br><br>Interestingly, this is precisely a zero-inflated binomial model (see &quot;Gentians&quot; example). The population size parameter is a derived parameter:<br><br>N = </font><font face="Symbol" color="#000100" size="5">S</font><font face="Arial" color="#000100" size="3">z</font><font face="Arial" color="#000100" size="2"><sub>i</sub></font><font face="Arial" color="#000100" size="3">.<br><br>Some discussion of data augmentation in this context can be found in Royle, Dorazio and Link (JCGS, 2007) as well as in Royle and Dorazio (Academic Press, 2008). Care should be taken in choice of M -- a value too small will cause posterior mass to pile up on the boundary N=M. As the intent of the discrete uniform prior is to express the absence of prior information, M should be increased in such cases. But note that too large a value of M yields increased computational burden.<br><br>The model in the BUGS language is <br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">model {<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#0000FF" size="3">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># prior distributions<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">psi ~ dunif(0, 1)<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">p ~ dunif(0,1)<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># zero-inflated binomial model for the augmented data<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">for(i in 1 : nind + nz){<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">z[i] ~ dbern(psi)<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">mu[i] &lt;- z[i ]* p<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">y[i] ~ dbin(mu[i], J)<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3">}<br></font><font face="Arial" color="#000000" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000000" size="3"># N is a derived parameter under data augmentation</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">N&lt;-sum(z[])<br></font><font face="Arial" color="#000100" size="1">&nbsp;&nbsp;&nbsp;</font><font face="Arial" color="#000100" size="3">}<br><br></font><font face="Courier New" color="#000100" size="6">Example analysis</font><font face="Arial" color="#0000FF" size="5"><br></font><font face="Arial" color="#000100" size="3"><br>The data are capture-recapture data on voles</font><font face="Arial" color="#000100" size="3"><em> </em></font><font face="Arial" color="#000100" size="3">(Microtus) (see Williams, Nichols and Conroy, Academic Press, 2002, for additional details and more extensive data). The study was conducted over J = 5 days and yielded encounter histories on nind = 56 individuals. For this analysis, the data set was augmented with nz = 60 individuals. This example comes from Chapter 5 of Royle and Dorazio (Academic Press, 2008). <br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volesdata.html"></font><font face="Arial" color="#0000FF" size="5"><u>Data</u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br><br><br></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volesinits1.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;1</u></font><font face="Arial" color="#0000FF" size="3"> </a></font><font face="Arial" color="#0000FF" size="3"><strong> </strong></font><font face="Arial" color="#0000FF" size="3"><a href="../Examples/Volesinits2.html"></font><font face="Arial" color="#0000FF" size="5"><u>Inits&nbsp;for&nbsp;chain&nbsp;2 </u></font><font face="Arial" color="#0000FF" size="3"></a></font><font face="Arial" color="#0000FF" size="5"><u> </u></font><font face="Arial" color="#000100" size="3">( click to open )</font><font face="Arial" color="#000100" size="3"><br></font><font face="Arial" color="#000100" size="2"><br></font><font face="Arial" color="#000100" size="1"><br><br></font><font face="Arial" color="#0000FF" size="5">Results<br></font><font face="Arial" color="#000100" size="1"><br></font><font face="Arial" color="#000100" size="3">Two chains were run for 11000 iterations which produced the following estimates. Note that the posterior mode of N is on the boundary N = nind, a result of the high per sample detection probability (posterior mean of p = 0.63).<br><center></font><font face="Arial" color="#000100" size="1"><br><img src="voles1.bmp" alt="[voles1]"></font><font face="Arial" color="#000100" size="3"><br></center><br><br><img src="voles2.bmp" alt="[voles2]"><img src="voles3.bmp" alt="[voles3]"><br><img src="voles4.bmp" alt="[voles4]"></font></p></body></html>